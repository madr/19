<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Hur nya madr.se byggdes | Skrivna ord av Anders Ytterstr√∂m</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:title content="Hur nya madr.se byggdes"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterstr√∂m"></head><body><a href=#content class=skiplink>Hoppa till inneh√•ll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018." loading=lazy></a><p class=presentation>Anders √§r en webbutvecklare och h√•rdrockare som gillar br√§dspel, kaffe och √∂l. <a href=../../om/ rel=author>Om Anders Ytterstr√∂m</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../1/ >‚úí Inl√§gg</a> <a class=nav__item href=../../bl/ >ü§ò Br√ºtal Legend</a> <a class=nav__item href=../../evenemang/ >üìÖ Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >üé≤ Br√§dspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >ü¶æ Styrketr√§ning</a></nav></header><main id=content><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>Hur nya madr.se byggdes</h1></header><div itemprop=articleBody><p>Madr.se har varit det st&#xE4;ndiga offret n&#xE4;r jag vill l&#xE4;ra mig n&#xE5;got nytt. Den nyaste versionen av sajten &#xE4;r inget undantag.</p><h2 id=tack-och-adj-posterous>Tack och adj&#xF6;, Posterous<a class=anchor href=#tack-och-adj-posterous>&#xB6;</a></h2><p>Jag har verkligen ingenting ont att s&#xE4;ga om <a href=http://madrse.posterous.com>Posterous</a> d&#xE5; det verktyget hade mycket positiv inverkan p&#xE5; mitt bloggande under tv&#xE5; &#xE5;r. Jag k&#xE4;nner dock att jag saknat m&#xF6;jligheten att &#xF6;ppna huven och skruva p&#xE5; (l&#xE4;s: pilla p&#xE5;) saker.</p><p>Alla gamla inl&#xE4;gg som tidigare l&#xE5;g p&#xE5; Posterous &#xE4;r kvar p&#xE5; sina gamla permal&#xE4;nkar, fr&#xE4;mst eftersom jag inte har till&#xE5;telse att s&#xE4;tta den h&#xE4;r sajten till huvuddom&#xE4;nen d&#xE5; det kr&#xE4;ver &#xE5;tkomst till <code>CNAME</code>.</p><p>Jag &#xE4;r inte beredd att g&#xE5; tillbaka till ett eget webbramverk fr&#xE5;n scratch som driftas p&#xE5; en egen server i vardagsrummet: snarare vill jag v&#xE4;lja n&#xE5;got som <strong>&#xE4;r utanf&#xF6;r min konfortzon</strong> och som <strong>verkar vara riktigt h&#xE4;ftigt och v&#xE4;l igenomt&#xE4;nkt</strong>.</p><h2 id=utvecklat-i-django>Utvecklat i Django<a class=anchor href=#utvecklat-i-django>&#xB6;</a></h2><p>D&#xE4;rav f&#xF6;ll mitt val p&#xE5; <strong>Django</strong> d&#xE5; dess slogan <a href=https://www.djangoproject.com/ >The Web framework for perfectionists with deadlines</a> &#xE4;r alldeles f&#xF6;r provocerande f&#xF6;r att motst&#xE5;. Python &#xE4;r ingenting jag anv&#xE4;nt till stor utstr&#xE4;ckning, men det &#xE4;r ett spr&#xE5;k som jag alltid haft en bra magk&#xE4;nsla inf&#xF6;r.</p><p>Att f&#xE5; ihop grundl&#xE4;ggande bloggfunktionalitet var <strong>busenkelt</strong>. Helt p&#xE5; k&#xF6;pet fick jag ett <strong>minimalt, men &#xE4;nd&#xE5; funktionsdugligt</strong> CMS f&#xF6;r att skriva och hantera inl&#xE4;gg.</p><p>Tre saker jag gillar med Django:</p><ul><li>Mallspr&#xE5;ket, som lyckas med bragden att g&#xF6;ra sitt jobb utan att vara i v&#xE4;gen eller bromsa.</li><li>Konventionerna f&#xF6;r filer och kataloger. Det g&#xE5;r att hitta saker spontant bara genom att se hur saker &#xE4;r d&#xF6;pta.</li><li>Definitionen av url-routes. Ett enkelt regex.</li></ul><h2 id=drift-i-heroku-och-amazon-s3>Drift i Heroku och Amazon S3<a class=anchor href=#drift-i-heroku-och-amazon-s3>&#xB6;</a></h2><p><a href=http://heroku.com>Heroku</a> &#xE4;r n&#xE5;got jag anv&#xE4;nder mycket s&#xE5;v&#xE4;l i jobbet som f&#xF6;r privata projekt, och en av anledningarna till att den h&#xE4;r sajten blev av &#xE4;r f&#xF6;r att Heroku sedan en tid st&#xF6;djer system utvecklade i Python.</p><p>P&#xE5; Heroku anv&#xE4;nder jag f&#xF6;ljande addons:</p><ul><li><strong>Scheduler</strong>, f&#xF6;r schemalagda bakgrundsjobb (t ex cachning av sidspalterna p&#xE5; den h&#xE4;r sajten).</li></ul><p>F&#xF6;r att inte lasta Heroku mer &#xE4;n n&#xF6;dv&#xE4;ndigt ligger mina statiska filer (CSS, JavaScript, bilder) i <a href=http://aws.amazon.com/s3/ >Amazon S3</a> d&#xE4;r jag enkelt kan hantera expires-headers och annat.</p><h2 id=mobile-first>Mobile first<a class=anchor href=#mobile-first>&#xB6;</a></h2><p>I dagar d&#xE4;r f&#xF6;ljsam design &#xE4;r poppis &#xE4;r det en yrkesskyldighet att applicera media queries. Jag har dock &#xE4;ven valt att k&#xF6;ra <a href=http://www.lukew.com/ff/entry.asp?933>Mobile first</a> genom att applicera f&#xF6;ljande principer:</p><ul><li>Minimal vikt. Inga CSS- eller JS-bibliotek, bara handskriven, dom&#xE4;nspecifik kod som dessutom &#xE4;r minifierad. CSS3 ist&#xE4;llet f&#xF6;r CSS-bilder.</li><li>Stor typografi f&#xF6;r l&#xF6;ptext med (relativt) h&#xF6;g kontrast. <a href=http://www.zeldman.com/2012/05/18/web-design-manifesto-2012/ >Web Design Manifesto 2012</a></li><li>Favikoner och diverse anpassningar (<code>viewport</code> och annat) f&#xF6;r webbl&#xE4;sare i mobiler.</li><li>Appcache-manifest f&#xF6;r att erbjuda permanent lagring av CSS, favikoner och JavaScript.</li></ul><h2 id=kort-om-kod>Kort om kod<a class=anchor href=#kort-om-kod>&#xB6;</a></h2><p>Jag validerar och lintar sajtens frontend-kod med <a href=http://gruntjs.com/ >Grunt</a>. Grunt anv&#xE4;nds &#xE4;ven f&#xF6;r att ladda upp filer till Amazon S3. H&#xE4;r &#xE4;r min Gruntfile:</p><pre><code>module.exports = function(grunt) {
  // Project configuration.
  grunt.initConfig({
    pkg: grunt.file.readJSON(&apos;package.json&apos;),
    aws: grunt.file.readJSON(&apos;../../../Dropbox/madrse/grunt-aws.json&apos;),
    s3: {
      options: {
        key: &apos;&lt;%= aws.key %&gt;&apos;,
        secret: &apos;&lt;%= aws.secret %&gt;&apos;,
        bucket: &apos;&lt;%= aws.bucket %&gt;&apos;,
        access: &apos;public-read&apos;,
        headers: {
          // Two Year cache policy (1000 * 60 * 60 * 24 * 730)
          &quot;Cache-Control&quot;: &quot;max-age=630720000, public&quot;,
          &quot;Expires&quot;: new Date(Date.now() + 63072000000).toUTCString()
        }
      },
      dev: {
        options: {
          maxOperations: 20
        },
        upload: [
          {
            src: &apos;../../../Dropbox/madrse/assets/*.png&apos;,
            dest: &apos;assets/&apos;
          },
          {
            src: &apos;madrse.appcache&apos;,
            dest: &apos;madrse.appcache&apos;
          },
          {
            src: &apos;admin/*&apos;,
            dest: &apos;admin/&apos;
          },
          {
            src: &apos;img/*.png&apos;,
            dest: &apos;img/&apos;
          },
          {
            src: &apos;dist/*&apos;,
            dest: &apos;dist/&apos;
          }
        ]
      }
    },
    csslint: {
      strict: {
        src: [&apos;dist/design.css&apos;]
      }
    },
    devserver: {
      &quot;options&quot;: {
        &quot;port&quot;: 8888
      },
      server: {}
    },
    less: {
      development: {
        files: {
          &quot;dist&quot;: &quot;src/less&quot;
        },
        files: {
          &quot;dist/design.css&quot;: &quot;src/less/*.less&quot;
        }
      },
      production: {
        options: {
          cleancss: true
        },
        files: {
          &quot;dist/design.min.css&quot;: &quot;src/less/*.less&quot;
        }
      }
    },
    uglify: {
      options: {
        banner: &apos;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&apos;
      },
      build: {
        src: &apos;dist/app.js&apos;,
        dest: &apos;dist/app.min.js&apos;
      }
    }
  });

  grunt.loadNpmTasks(&apos;grunt-contrib-csslint&apos;);
  grunt.loadNpmTasks(&apos;grunt-contrib-less&apos;);
  grunt.loadNpmTasks(&apos;grunt-devserver&apos;);
  grunt.loadNpmTasks(&apos;grunt-s3&apos;);
  
  grunt.registerTask(&apos;deploy&apos;, [&apos;less:production&apos;, &apos;less:development&apos;, &apos;s3&apos;]);
  grunt.registerTask(&apos;test&apos;, [&apos;csslint&apos;]);
  grunt.registerTask(&apos;default&apos;, [&apos;test&apos;]);
};
</code></pre><p>G&#xE4;llande CSS anv&#xE4;nder jag senaste kopian av <a href=https://gist.github.com/madr/6622974>site.less</a>, en gist jag st&#xE4;ndigt uppdaterar och f&#xF6;rb&#xE4;ttrar.</p><p>Koden i produktion &#xE4;r minifierad enligt rekommendation, men f&#xF6;r den som &#xE4;r intresserad finns &#xE4;ven orginalen uppladdade p&#xE5; S3:</p><ul><li><a href=http://madrse.s3.amazonaws.com/dist/design.css>CSS f&#xF6;r nya madr.se</a></li></ul><h2 id=tack>Tack<a class=anchor href=#tack>&#xB6;</a></h2><p>&#xC4;ra den som &#xE4;ras b&#xF6;r. Jag skapade den h&#xE4;r sajten utifr&#xE5;n n&#xE5;gra principer, de fr&#xE4;msta h&#xE4;r nedan:</p><ul><li>Ethan Schoonover, f&#xF6;r f&#xE4;rgs&#xE4;ttningen <a href=http://ethanschoonover.com/solarized>Solarized</a>.</li><li>Rachel Andrew, f&#xF6;r stor inspiration: <a href=http://www.rachelandrew.co.uk/archives/2012/03/21/stop-solving-problems-you-dont-yet-have/ >Stop solving problems you don&apos;t yet have</a>.</li><li>All samlad och delad visdom i <a href=http://html5boilerplate.com>HTML5 Boilerplate</a>.</li><li>Nicolas Gallagher &amp; Jonathan Neal f&#xF6;r <a href=necolas.github.com/normalize.css/ >normalise.css</a>.</li></ul></div><footer class=visuallyhidden><time itemprop=datePublished>2012-07-22</time> av <span itemprop=author itemscope itemtype=http://schema.org/Person><span itemprop=name>Anders Ytterstr√∂m</span>.</span></footer></article></main><aside><h2 class=h--aside>Senaste inl√§ggen</h2><ul class=recents><li class=recents__item><a href=../../2020/house-of-metal-14>House of Metal 14</a></li><li class=recents__item><a href=../../2020/telefon>√ñnskelista inf√∂r telefonbytet 2022-2025</a></li><li class=recents__item><a href=../../2020/1000lbs>V√§gen mot 1000 lbs club</a></li><li class=recents__item><a href=../../2020/coraline>Coraline</a></li><li class=recents__item><a href=../../2020/ungoogled-android>Android utan Googles appar</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Uada Pt. II: European Alliance </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Slaktkyrkan</span>, Stockholm </span></span><time datetime=2020-05-03T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>3</span> <span>maj</span></time><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Sweden Rock Festival 29 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Norje</span>, S√∂lvesborg </span></span><time datetime=2020-06-03T00:00:00Z class=upcoming__item__when itemprop=startDate><span>3</span> <span>jun</span> </time><span class=visuallyhidden itemprop=endDate>Sat Jun 06 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Korn </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Gr√∂na lund</span>, Stockholm </span></span><time datetime=2020-06-17T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>17</span> <span>jun</span></time><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Disturbed </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Gr√∂na lund</span>, Stockholm </span></span><time datetime=2020-06-24T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>24</span> <span>jun</span></time><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Gefle Metal Festival 5 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Gasklockorna</span>, G√§vle </span></span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span> </time><span class=visuallyhidden itemprop=endDate>Sat Jul 11 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Pixies </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Gr√∂na lund</span>, Stockholm </span></span><time datetime=2020-07-27T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>27</span> <span>jul</span></time><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Wacken</span>, Tyskland </span></span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span> </time><span class=visuallyhidden itemprop=endDate>Sat Aug 01 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Jaromƒõ≈ô</span>, Tjeckien </span></span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span> </time><span class=visuallyhidden itemprop=endDate>Sat Aug 08 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Watain </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Parksn√§ckan</span>, Uppsala </span></span><time datetime=2020-09-12T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>12</span> <span>sep</span></time><div class=visuallyhidden itemprop=description><p>Flyttad fr&#xE5;n 30 april p&#xE5; grund av COVID-19.</p></div><span class=visuallyhidden itemprop=address></span></li></ul></aside><footer><p>Publicerades <time>2012-07-22</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr√∂m sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och <a href=https://www.quirksmode.org/blog/archives/2020/01/css4_is_here.html>CSS4</a>.</p></footer></body></html>