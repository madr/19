<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Hur nya madr.se byggdes | Anders Ytterstr√∂ms hemsida</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=/madrse.css><link href=/prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:title content="Hur nya madr.se byggdes"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:image content=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276><meta property=og:site_name content="Anders Ytterstr√∂ms hemsida"></head><body><a href=#content class=skiplink>Hoppa till inneh√•ll</a><header><a href=/ rel=home>madr.se</a><nav><a href=/bl/ >ü§ò Br√ºtal Legend</a> <a href=/evenemang/ >üìÖ Evenemang</a> <a href=/om/ >ü§∑‚Äç‚ôÇÔ∏è Om</a> <a href=http://broken-close-swan.gigalixirapp.com/live>üé≤ RISK</a> <a href=/prenumerera.xml rel=alternate title="Prenumerera via Atom">üì£</a></nav></header><main id=content><article><h1>Hur nya madr.se byggdes</h1><footer><time>2012-07-22</time> av <a rel=author href=/om><img src=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276 alt=portr√§tt> Anders Ytterstr√∂m</a></footer><p>Madr.se har varit det st√§ndiga offret n√§r jag vill l√§ra mig n√•got nytt. Den nyaste versionen av sajten √§r inget undantag.</p><h2 id=tack-och-adj-posterous>Tack och adj√∂, Posterous</h2><p>Jag har verkligen ingenting ont att s√§ga om <a href=http://madrse.posterous.com>Posterous</a> d√• det verktyget hade mycket positiv inverkan p√• mitt bloggande under tv√• √•r. Jag k√§nner dock att jag saknat m√∂jligheten att √∂ppna huven och skruva p√• (l√§s: pilla p√•) saker.</p><p>Alla gamla inl√§gg som tidigare l√•g p√• Posterous √§r kvar p√• sina gamla permal√§nkar, fr√§mst eftersom jag inte har till√•telse att s√§tta den h√§r sajten till huvuddom√§nen d√• det kr√§ver √•tkomst till <code>CNAME</code>.</p><p>Jag √§r inte beredd att g√• tillbaka till ett eget webbramverk fr√•n scratch som driftas p√• en egen server i vardagsrummet: snarare vill jag v√§lja n√•got som <strong>√§r utanf√∂r min konfortzon</strong> och som <strong>verkar vara riktigt h√§ftigt och v√§l igenomt√§nkt</strong>.</p><h2 id=utvecklat-i-django>Utvecklat i Django</h2><p>D√§rav f√∂ll mitt val p√• <strong>Django</strong> d√• dess slogan <a href=https://www.djangoproject.com/ >The Web framework for perfectionists with deadlines</a> √§r alldeles f√∂r provocerande f√∂r att motst√•. Python √§r ingenting jag anv√§nt till stor utstr√§ckning, men det √§r ett spr√•k som jag alltid haft en bra magk√§nsla inf√∂r.</p><p>Att f√• ihop grundl√§ggande bloggfunktionalitet var <strong>busenkelt</strong>. Helt p√• k√∂pet fick jag ett <strong>minimalt, men √§nd√• funktionsdugligt</strong> CMS f√∂r att skriva och hantera inl√§gg.</p><p>Tre saker jag gillar med Django:</p><ul><li>Mallspr√•ket, som lyckas med bragden att g√∂ra sitt jobb utan att vara i v√§gen eller bromsa.</li><li>Konventionerna f√∂r filer och kataloger. Det g√•r att hitta saker spontant bara genom att se hur saker √§r d√∂pta.</li><li>Definitionen av url-routes. Ett enkelt regex.</li></ul><h2 id=drift-i-heroku-och-amazon-s3>Drift i Heroku och Amazon S3</h2><p><a href=http://heroku.com>Heroku</a> √§r n√•got jag anv√§nder mycket s√•v√§l i jobbet som f√∂r privata projekt, och en av anledningarna till att den h√§r sajten blev av √§r f√∂r att Heroku sedan en tid st√∂djer system utvecklade i Python.</p><p>P√• Heroku anv√§nder jag f√∂ljande addons:</p><ul><li><strong>Scheduler</strong>, f√∂r schemalagda bakgrundsjobb (t ex cachning av sidspalterna p√• den h√§r sajten).</li></ul><p>F√∂r att inte lasta Heroku mer √§n n√∂dv√§ndigt ligger mina statiska filer (CSS, JavaScript, bilder) i <a href=http://aws.amazon.com/s3/ >Amazon S3</a> d√§r jag enkelt kan hantera expires-headers och annat.</p><h2 id=mobile-first>Mobile first</h2><p>I dagar d√§r f√∂ljsam design √§r poppis √§r det en yrkesskyldighet att applicera media queries. Jag har dock √§ven valt att k√∂ra <a href=http://www.lukew.com/ff/entry.asp?933>Mobile first</a> genom att applicera f√∂ljande principer:</p><ul><li>Minimal vikt. Inga CSS- eller JS-bibliotek, bara handskriven, dom√§nspecifik kod som dessutom √§r minifierad. CSS3 ist√§llet f√∂r CSS-bilder.</li><li>Stor typografi f√∂r l√∂ptext med (relativt) h√∂g kontrast. <a href=http://www.zeldman.com/2012/05/18/web-design-manifesto-2012/ >Web Design Manifesto 2012</a></li><li>Favikoner och diverse anpassningar (<code>viewport</code> och annat) f√∂r webbl√§sare i mobiler.</li><li>Appcache-manifest f√∂r att erbjuda permanent lagring av CSS, favikoner och JavaScript.</li></ul><h2 id=kort-om-kod>Kort om kod</h2><p>Jag validerar och lintar sajtens frontend-kod med <a href=http://gruntjs.com/ >Grunt</a>. Grunt anv√§nds √§ven f√∂r att ladda upp filer till Amazon S3. H√§r √§r min Gruntfile:</p><pre><code>module.exports = function(grunt) {
  // Project configuration.
  grunt.initConfig({
    pkg: grunt.file.readJSON(&#39;package.json&#39;),
    aws: grunt.file.readJSON(&#39;../../../Dropbox/madrse/grunt-aws.json&#39;),
    s3: {
      options: {
        key: &#39;&lt;%= aws.key %&gt;&#39;,
        secret: &#39;&lt;%= aws.secret %&gt;&#39;,
        bucket: &#39;&lt;%= aws.bucket %&gt;&#39;,
        access: &#39;public-read&#39;,
        headers: {
          // Two Year cache policy (1000 * 60 * 60 * 24 * 730)
          &quot;Cache-Control&quot;: &quot;max-age=630720000, public&quot;,
          &quot;Expires&quot;: new Date(Date.now() + 63072000000).toUTCString()
        }
      },
      dev: {
        options: {
          maxOperations: 20
        },
        upload: [
          {
            src: &#39;../../../Dropbox/madrse/assets/*.png&#39;,
            dest: &#39;assets/&#39;
          },
          {
            src: &#39;madrse.appcache&#39;,
            dest: &#39;madrse.appcache&#39;
          },
          {
            src: &#39;admin/*&#39;,
            dest: &#39;admin/&#39;
          },
          {
            src: &#39;img/*.png&#39;,
            dest: &#39;img/&#39;
          },
          {
            src: &#39;dist/*&#39;,
            dest: &#39;dist/&#39;
          }
        ]
      }
    },
    csslint: {
      strict: {
        src: [&#39;dist/design.css&#39;]
      }
    },
    devserver: {
      &quot;options&quot;: {
        &quot;port&quot;: 8888
      },
      server: {}
    },
    less: {
      development: {
        files: {
          &quot;dist&quot;: &quot;src/less&quot;
        },
        files: {
          &quot;dist/design.css&quot;: &quot;src/less/*.less&quot;
        }
      },
      production: {
        options: {
          cleancss: true
        },
        files: {
          &quot;dist/design.min.css&quot;: &quot;src/less/*.less&quot;
        }
      }
    },
    uglify: {
      options: {
        banner: &#39;/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n&#39;
      },
      build: {
        src: &#39;dist/app.js&#39;,
        dest: &#39;dist/app.min.js&#39;
      }
    }
  });

  grunt.loadNpmTasks(&#39;grunt-contrib-csslint&#39;);
  grunt.loadNpmTasks(&#39;grunt-contrib-less&#39;);
  grunt.loadNpmTasks(&#39;grunt-devserver&#39;);
  grunt.loadNpmTasks(&#39;grunt-s3&#39;);

  grunt.registerTask(&#39;deploy&#39;, [&#39;less:production&#39;, &#39;less:development&#39;, &#39;s3&#39;]);
  grunt.registerTask(&#39;test&#39;, [&#39;csslint&#39;]);
  grunt.registerTask(&#39;default&#39;, [&#39;test&#39;]);
};</code></pre><p>G√§llande CSS anv√§nder jag senaste kopian av <a href=https://gist.github.com/madr/6622974>site.less</a>, en gist jag st√§ndigt uppdaterar och f√∂rb√§ttrar.</p><p>Koden i produktion √§r minifierad enligt rekommendation, men f√∂r den som √§r intresserad finns √§ven orginalen uppladdade p√• S3:</p><ul><li><a href=http://madrse.s3.amazonaws.com/dist/design.css>CSS f√∂r nya madr.se</a></li></ul><h2 id=tack>Tack</h2><p>√Ñra den som √§ras b√∂r. Jag skapade den h√§r sajten utifr√•n n√•gra principer, de fr√§msta h√§r nedan:</p><ul><li>Ethan Schoonover, f√∂r f√§rgs√§ttningen <a href=http://ethanschoonover.com/solarized>Solarized</a>.</li><li>Rachel Andrew, f√∂r stor inspiration: <a href=http://www.rachelandrew.co.uk/archives/2012/03/21/stop-solving-problems-you-dont-yet-have/ >Stop solving problems you don&#39;t yet have</a>.</li><li>All samlad och delad visdom i <a href=http://html5boilerplate.com>HTML5 Boilerplate</a>.</li><li>Nicolas Gallagher &amp; Jonathan Neal f√∂r <a href=necolas.github.com/normalize.css/ >normalise.css</a>.</li></ul></article></main><footer><p><a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr√∂m sedan dec 2006. <a rel=alternate href=/prenumerera.xml>Prenumerera</a>.</p></footer></body></html>