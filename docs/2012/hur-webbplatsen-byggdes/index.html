<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Hur nya madr.se byggdes | Skrivna ord av Anders Ytterström.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:title content="Hur nya madr.se byggdes"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterström."></head><body><a href=#content class=skiplink>Hoppa till innehåll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders är en webbutvecklare och hårdrockare som gillar brädspel, kaffe och öl. <a href=../../om/ rel=author>Om Anders Ytterström</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >🤘 Brütal Legend</a> <a class=nav__item href=../../evenemang/ >📅 Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >🎲 Brädspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >🦾 Styrketräning</a></nav></header><main id=content><article><h1>Hur nya madr.se byggdes</h1><p>Madr.se har varit det ständiga offret när jag vill lära mig något nytt. Den nyaste versionen av sajten är inget undantag.</p><h2>Tack och adjö, Posterous</h2><p>Jag har verkligen ingenting ont att säga om <a href=http://madrse.posterous.com>Posterous</a> då det verktyget hade mycket positiv inverkan på mitt bloggande under två år. Jag känner dock att jag saknat möjligheten att öppna huven och skruva på (läs: pilla på) saker.</p><p>Alla gamla inlägg som tidigare låg på Posterous är kvar på sina gamla permalänkar, främst eftersom jag inte har tillåtelse att sätta den här sajten till huvuddomänen då det kräver åtkomst till <code>CNAME</code>.</p><p>Jag är inte beredd att gå tillbaka till ett eget webbramverk från scratch som driftas på en egen server i vardagsrummet: snarare vill jag välja något som <strong>är utanför min konfortzon</strong> och som <strong>verkar vara riktigt häftigt och väl igenomtänkt</strong>.</p><h2>Utvecklat i Django</h2><p>Därav föll mitt val på <strong>Django</strong> då dess slogan <a href=https://www.djangoproject.com/ >The Web framework for perfectionists with deadlines</a> är alldeles för provocerande för att motstå. Python är ingenting jag använt till stor utsträckning, men det är ett språk som jag alltid haft en bra magkänsla inför.</p><p>Att få ihop grundläggande bloggfunktionalitet var <strong>busenkelt</strong>. Helt på köpet fick jag ett <strong>minimalt, men ändå funktionsdugligt</strong> CMS för att skriva och hantera inlägg.</p><p>Tre saker jag gillar med Django:</p><ul><li>Mallspråket, som lyckas med bragden att göra sitt jobb utan att vara i vägen eller bromsa.</li><li>Konventionerna för filer och kataloger. Det går att hitta saker spontant bara genom att se hur saker är döpta.</li><li>Definitionen av url-routes. Ett enkelt regex.</li></ul><h2>Drift i Heroku och Amazon S3</h2><p><a href=http://heroku.com>Heroku</a> är något jag använder mycket såväl i jobbet som för privata projekt, och en av anledningarna till att den här sajten blev av är för att Heroku sedan en tid stödjer system utvecklade i Python.</p><p>På Heroku använder jag följande addons:</p><ul><li><strong>Scheduler</strong>, för schemalagda bakgrundsjobb (t ex cachning av sidspalterna på den här sajten).</li></ul><p>För att inte lasta Heroku mer än nödvändigt ligger mina statiska filer (CSS, JavaScript, bilder) i <a href=http://aws.amazon.com/s3/ >Amazon S3</a> där jag enkelt kan hantera expires-headers och annat.</p><h2>Mobile first</h2><p>I dagar där följsam design är poppis är det en yrkesskyldighet att applicera media queries. Jag har dock även valt att köra <a href=http://www.lukew.com/ff/entry.asp?933>Mobile first</a> genom att applicera följande principer:</p><ul><li>Minimal vikt. Inga CSS- eller JS-bibliotek, bara handskriven, domänspecifik kod som dessutom är minifierad. CSS3 istället för CSS-bilder.</li><li>Stor typografi för löptext med (relativt) hög kontrast. <a href=http://www.zeldman.com/2012/05/18/web-design-manifesto-2012/ >Web Design Manifesto 2012</a></li><li>Favikoner och diverse anpassningar (<code>viewport</code> och annat) för webbläsare i mobiler.</li><li>Appcache-manifest för att erbjuda permanent lagring av CSS, favikoner och JavaScript.</li></ul><h2>Kort om kod</h2><p>Jag validerar och lintar sajtens frontend-kod med <a href=http://gruntjs.com/ >Grunt</a>. Grunt används även för att ladda upp filer till Amazon S3. Här är min Gruntfile:</p><pre><code>module.exports = function(grunt) {
  // Project configuration.
  grunt.initConfig({
    pkg: grunt.file.readJSON('package.json'),
    aws: grunt.file.readJSON('../../../Dropbox/madrse/grunt-aws.json'),
    s3: {
      options: {
        key: '&lt;%= aws.key %&gt;',
        secret: '&lt;%= aws.secret %&gt;',
        bucket: '&lt;%= aws.bucket %&gt;',
        access: 'public-read',
        headers: {
          // Two Year cache policy (1000 * 60 * 60 * 24 * 730)
          &quot;Cache-Control&quot;: &quot;max-age=630720000, public&quot;,
          &quot;Expires&quot;: new Date(Date.now() + 63072000000).toUTCString()
        }
      },
      dev: {
        options: {
          maxOperations: 20
        },
        upload: [
          {
            src: '../../../Dropbox/madrse/assets/*.png',
            dest: 'assets/'
          },
          {
            src: 'madrse.appcache',
            dest: 'madrse.appcache'
          },
          {
            src: 'admin/*',
            dest: 'admin/'
          },
          {
            src: 'img/*.png',
            dest: 'img/'
          },
          {
            src: 'dist/*',
            dest: 'dist/'
          }
        ]
      }
    },
    csslint: {
      strict: {
        src: ['dist/design.css']
      }
    },
    devserver: {
      &quot;options&quot;: {
        &quot;port&quot;: 8888
      },
      server: {}
    },
    less: {
      development: {
        files: {
          &quot;dist&quot;: &quot;src/less&quot;
        },
        files: {
          &quot;dist/design.css&quot;: &quot;src/less/*.less&quot;
        }
      },
      production: {
        options: {
          cleancss: true
        },
        files: {
          &quot;dist/design.min.css&quot;: &quot;src/less/*.less&quot;
        }
      }
    },
    uglify: {
      options: {
        banner: '/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n'
      },
      build: {
        src: 'dist/app.js',
        dest: 'dist/app.min.js'
      }
    }
  });

  grunt.loadNpmTasks('grunt-contrib-csslint');
  grunt.loadNpmTasks('grunt-contrib-less');
  grunt.loadNpmTasks('grunt-devserver');
  grunt.loadNpmTasks('grunt-s3');
  
  grunt.registerTask('deploy', ['less:production', 'less:development', 's3']);
  grunt.registerTask('test', ['csslint']);
  grunt.registerTask('default', ['test']);
};
</code></pre><p>Gällande CSS använder jag senaste kopian av <a href=https://gist.github.com/madr/6622974>site.less</a>, en gist jag ständigt uppdaterar och förbättrar.</p><p>Koden i produktion är minifierad enligt rekommendation, men för den som är intresserad finns även orginalen uppladdade på S3:</p><ul><li><a href=http://madrse.s3.amazonaws.com/dist/design.css>CSS för nya madr.se</a></li></ul><h2>Tack</h2><p>Ära den som äras bör. Jag skapade den här sajten utifrån några principer, de främsta här nedan:</p><ul><li>Ethan Schoonover, för färgsättningen <a href=http://ethanschoonover.com/solarized>Solarized</a>.</li><li>Rachel Andrew, för stor inspiration: <a href=http://www.rachelandrew.co.uk/archives/2012/03/21/stop-solving-problems-you-dont-yet-have/ >Stop solving problems you don't yet have</a>.</li><li>All samlad och delad visdom i <a href=http://html5boilerplate.com>HTML5 Boilerplate</a>.</li><li>Nicolas Gallagher &amp; Jonathan Neal för <a href=necolas.github.com/normalize.css/ >normalise.css</a>.</li></ul></article></main><aside><h2 class=h--aside>Senaste inläggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad berättar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>Gärning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varför och hur jag ska fördjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/brutallegend-17>Angel Witch - Angel Witch #bl17</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, Gävle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jaroměř</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2012-07-22</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterström sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>