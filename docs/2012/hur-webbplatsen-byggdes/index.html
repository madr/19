<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Hur nya madr.se byggdes | Skrivna ord av Anders Ytterstr칬m.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:title content="Hur nya madr.se byggdes"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2012/hur-webbplatsen-byggdes/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterstr칬m."></head><body><a href=#content class=skiplink>Hoppa till inneh친ll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders 칛r en webbutvecklare och h친rdrockare som gillar br칛dspel, kaffe och 칬l. <a href=../../om/ rel=author>Om Anders Ytterstr칬m</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >游뱆 Br칲tal Legend</a> <a class=nav__item href=../../evenemang/ >游늰 Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >游 Br칛dspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >游 Styrketr칛ning</a></nav></header><main id=content><article><h1>Hur nya madr.se byggdes</h1><p>Madr.se har varit det st칛ndiga offret n칛r jag vill l칛ra mig n친got nytt. Den nyaste versionen av sajten 칛r inget undantag.</p><h2>Tack och adj칬, Posterous</h2><p>Jag har verkligen ingenting ont att s칛ga om <a href=http://madrse.posterous.com>Posterous</a> d친 det verktyget hade mycket positiv inverkan p친 mitt bloggande under tv친 친r. Jag k칛nner dock att jag saknat m칬jligheten att 칬ppna huven och skruva p친 (l칛s: pilla p친) saker.</p><p>Alla gamla inl칛gg som tidigare l친g p친 Posterous 칛r kvar p친 sina gamla permal칛nkar, fr칛mst eftersom jag inte har till친telse att s칛tta den h칛r sajten till huvuddom칛nen d친 det kr칛ver 친tkomst till <code>CNAME</code>.</p><p>Jag 칛r inte beredd att g친 tillbaka till ett eget webbramverk fr친n scratch som driftas p친 en egen server i vardagsrummet: snarare vill jag v칛lja n친got som <strong>칛r utanf칬r min konfortzon</strong> och som <strong>verkar vara riktigt h칛ftigt och v칛l igenomt칛nkt</strong>.</p><h2>Utvecklat i Django</h2><p>D칛rav f칬ll mitt val p친 <strong>Django</strong> d친 dess slogan <a href=https://www.djangoproject.com/ >The Web framework for perfectionists with deadlines</a> 칛r alldeles f칬r provocerande f칬r att motst친. Python 칛r ingenting jag anv칛nt till stor utstr칛ckning, men det 칛r ett spr친k som jag alltid haft en bra magk칛nsla inf칬r.</p><p>Att f친 ihop grundl칛ggande bloggfunktionalitet var <strong>busenkelt</strong>. Helt p친 k칬pet fick jag ett <strong>minimalt, men 칛nd친 funktionsdugligt</strong> CMS f칬r att skriva och hantera inl칛gg.</p><p>Tre saker jag gillar med Django:</p><ul><li>Mallspr친ket, som lyckas med bragden att g칬ra sitt jobb utan att vara i v칛gen eller bromsa.</li><li>Konventionerna f칬r filer och kataloger. Det g친r att hitta saker spontant bara genom att se hur saker 칛r d칬pta.</li><li>Definitionen av url-routes. Ett enkelt regex.</li></ul><h2>Drift i Heroku och Amazon S3</h2><p><a href=http://heroku.com>Heroku</a> 칛r n친got jag anv칛nder mycket s친v칛l i jobbet som f칬r privata projekt, och en av anledningarna till att den h칛r sajten blev av 칛r f칬r att Heroku sedan en tid st칬djer system utvecklade i Python.</p><p>P친 Heroku anv칛nder jag f칬ljande addons:</p><ul><li><strong>Scheduler</strong>, f칬r schemalagda bakgrundsjobb (t ex cachning av sidspalterna p친 den h칛r sajten).</li></ul><p>F칬r att inte lasta Heroku mer 칛n n칬dv칛ndigt ligger mina statiska filer (CSS, JavaScript, bilder) i <a href=http://aws.amazon.com/s3/ >Amazon S3</a> d칛r jag enkelt kan hantera expires-headers och annat.</p><h2>Mobile first</h2><p>I dagar d칛r f칬ljsam design 칛r poppis 칛r det en yrkesskyldighet att applicera media queries. Jag har dock 칛ven valt att k칬ra <a href=http://www.lukew.com/ff/entry.asp?933>Mobile first</a> genom att applicera f칬ljande principer:</p><ul><li>Minimal vikt. Inga CSS- eller JS-bibliotek, bara handskriven, dom칛nspecifik kod som dessutom 칛r minifierad. CSS3 ist칛llet f칬r CSS-bilder.</li><li>Stor typografi f칬r l칬ptext med (relativt) h칬g kontrast. <a href=http://www.zeldman.com/2012/05/18/web-design-manifesto-2012/ >Web Design Manifesto 2012</a></li><li>Favikoner och diverse anpassningar (<code>viewport</code> och annat) f칬r webbl칛sare i mobiler.</li><li>Appcache-manifest f칬r att erbjuda permanent lagring av CSS, favikoner och JavaScript.</li></ul><h2>Kort om kod</h2><p>Jag validerar och lintar sajtens frontend-kod med <a href=http://gruntjs.com/ >Grunt</a>. Grunt anv칛nds 칛ven f칬r att ladda upp filer till Amazon S3. H칛r 칛r min Gruntfile:</p><pre><code>module.exports = function(grunt) {
  // Project configuration.
  grunt.initConfig({
    pkg: grunt.file.readJSON('package.json'),
    aws: grunt.file.readJSON('../../../Dropbox/madrse/grunt-aws.json'),
    s3: {
      options: {
        key: '&lt;%= aws.key %&gt;',
        secret: '&lt;%= aws.secret %&gt;',
        bucket: '&lt;%= aws.bucket %&gt;',
        access: 'public-read',
        headers: {
          // Two Year cache policy (1000 * 60 * 60 * 24 * 730)
          &quot;Cache-Control&quot;: &quot;max-age=630720000, public&quot;,
          &quot;Expires&quot;: new Date(Date.now() + 63072000000).toUTCString()
        }
      },
      dev: {
        options: {
          maxOperations: 20
        },
        upload: [
          {
            src: '../../../Dropbox/madrse/assets/*.png',
            dest: 'assets/'
          },
          {
            src: 'madrse.appcache',
            dest: 'madrse.appcache'
          },
          {
            src: 'admin/*',
            dest: 'admin/'
          },
          {
            src: 'img/*.png',
            dest: 'img/'
          },
          {
            src: 'dist/*',
            dest: 'dist/'
          }
        ]
      }
    },
    csslint: {
      strict: {
        src: ['dist/design.css']
      }
    },
    devserver: {
      &quot;options&quot;: {
        &quot;port&quot;: 8888
      },
      server: {}
    },
    less: {
      development: {
        files: {
          &quot;dist&quot;: &quot;src/less&quot;
        },
        files: {
          &quot;dist/design.css&quot;: &quot;src/less/*.less&quot;
        }
      },
      production: {
        options: {
          cleancss: true
        },
        files: {
          &quot;dist/design.min.css&quot;: &quot;src/less/*.less&quot;
        }
      }
    },
    uglify: {
      options: {
        banner: '/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today(&quot;yyyy-mm-dd&quot;) %&gt; */\n'
      },
      build: {
        src: 'dist/app.js',
        dest: 'dist/app.min.js'
      }
    }
  });

  grunt.loadNpmTasks('grunt-contrib-csslint');
  grunt.loadNpmTasks('grunt-contrib-less');
  grunt.loadNpmTasks('grunt-devserver');
  grunt.loadNpmTasks('grunt-s3');
  
  grunt.registerTask('deploy', ['less:production', 'less:development', 's3']);
  grunt.registerTask('test', ['csslint']);
  grunt.registerTask('default', ['test']);
};
</code></pre><p>G칛llande CSS anv칛nder jag senaste kopian av <a href=https://gist.github.com/madr/6622974>site.less</a>, en gist jag st칛ndigt uppdaterar och f칬rb칛ttrar.</p><p>Koden i produktion 칛r minifierad enligt rekommendation, men f칬r den som 칛r intresserad finns 칛ven orginalen uppladdade p친 S3:</p><ul><li><a href=http://madrse.s3.amazonaws.com/dist/design.css>CSS f칬r nya madr.se</a></li></ul><h2>Tack</h2><p>츿ra den som 칛ras b칬r. Jag skapade den h칛r sajten utifr친n n친gra principer, de fr칛msta h칛r nedan:</p><ul><li>Ethan Schoonover, f칬r f칛rgs칛ttningen <a href=http://ethanschoonover.com/solarized>Solarized</a>.</li><li>Rachel Andrew, f칬r stor inspiration: <a href=http://www.rachelandrew.co.uk/archives/2012/03/21/stop-solving-problems-you-dont-yet-have/ >Stop solving problems you don't yet have</a>.</li><li>All samlad och delad visdom i <a href=http://html5boilerplate.com>HTML5 Boilerplate</a>.</li><li>Nicolas Gallagher &amp; Jonathan Neal f칬r <a href=necolas.github.com/normalize.css/ >normalise.css</a>.</li></ul></article></main><aside><h2 class=h--aside>Senaste inl칛ggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad ber칛ttar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>G칛rning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varf칬r och hur jag ska f칬rdjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/brutallegend-17>Angel Witch - Angel Witch #bl17</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, G칛vle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jarom캩콏</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2012-07-22</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr칬m sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>