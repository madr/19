<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Automatisera JSLint med Git hooks och Node.js | Skrivna ord av Anders Ytterstr칬m.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2012/jslint-git-hook/ ><meta property=og:title content="Automatisera JSLint med Git hooks och Node.js"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2012/jslint-git-hook/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterstr칬m."></head><body><a href=#content class=skiplink>Hoppa till inneh친ll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders 칛r en webbutvecklare och h친rdrockare som gillar br칛dspel, kaffe och 칬l. <a href=../../om/ rel=author>Om Anders Ytterstr칬m</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >游뱆 Br칲tal Legend</a> <a class=nav__item href=../../evenemang/ >游늰 Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >游 Br칛dspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >游 Styrketr칛ning</a></nav></header><main id=content><article><h1>Automatisera JSLint med Git hooks och Node.js</h1><p>Jag har f칬r vana att kvalitets칛kra JavaScript med <a href=http://jslint.com>JSLint</a>. Fram tills nyligen har jag gjort detta i och med att jag 칛ven validerar min HTML och CSS, vilket h칛rlett till att jag automatiserat denna gemensamma aktivitet med <a href=https://github.com/madr/uidev-checklist>n친gra 친teranv칛ndningsbara Ant-targets</a> som flyttat mellan mina projekt hemma och p친 jobbet.</p><p>Jag 칛r r칛tt n칬jd med att kunna g칬ra dessa med en kommandorad i en terminal, men det finns alltid utrymme f칬r f칬rb칛ttringar. En brist med d친varande setup 칛r att JSLint inte k칬rs f칬rr칛n jag sj칛lv v칛ljer det, varvid n친gra d친liga rader kod faktiskt kan smyga ut i produktion om jag 칛r slarvig med att k칬ra ant.</p><p>D친 det mesta jag kodar versionshanteras med Git, finns det f칬rb칛ttringar att skapa utifr친n <a href=http://git-scm.com/book/en/Customizing-Git-Git-Hooks>Git hooks</a>. Med en <code>pre-commit</code> 칛r det om칬jligt att checka in d친lig kod eftersom JSlint kan neka incheckningen.</p><p>Jag t칛nker inte f칬rklara konceptet med git-hooks i detalj (l칛nken ovan g칬r det b칛ttre 칛n mig); jag ger ist칛llet iv칛g koden jag anv칛nder.</p><pre><code>#!/bin/sh
#
ROOT_DIR=$(git rev-parse --show-toplevel)
JSLINT=&quot;${ROOT_DIR}/node_modules/.bin/jslint&quot;
for file in $(git diff --cached --name-only | grep '\.js$'); do
  line=$(node $JSLINT $file | grep 'OK')
    if [ x&quot;$line&quot; = x ]; then
        node $JSLINT $file
        exit 1
    else
        echo &quot;jslint passed\n&quot;
    fi
done
exit 0
</code></pre><p>V칛rt att notera i ovanst친ende 칛r att jag anv칛nder <a href=http://nodejs.org>Node.js</a> f칬r att k칬ra JSLint. Detta g칬r jag f칬r att den 칛r 칬verl칛gset snabbast av alla implementationer av JSLint jag testat. Det g친r s친klart att k칬ra Rhino eller n친got annat ocks친.</p><p>F칬r att l칛gga till den h칛r git hooken i ett av dina projekt, g칬r s친 h칛r:</p><h1>Kopiera texten ovan.</h1><h1>칐ppna filen <code>.git/hooks/pre-commit.sample</code>.</h1><h1>Klistra in texten och spara.</h1><h1>D칬p om filen till <code>.git/hooks/pre-commit</code>.</h1><h1>G칬r den nya filen k칬rbar: <code>chmod +x .git/hooks/pre-commit</code>.</h1><p>F칬r att installera Node.js:</p><ol><li>Installera enligt instruktionerna p친 <a href=http://nodejs.org>Nodejs.org</a>.<br>a. Macanv칛ndare kan installera via brew: <code>brew install node</code> b. Arch-anv칛ndare kan installera via pacman: <code>pacman -S node</code></li><li>i en terminal, g친 till projektets rot.</li><li>installera jslint: <code>npm install jslint</code></li></ol><p>Jag anv칛nder sj칛lv den h칛r hooken i alla mina projekt sedan en vecka tillbaka och det 칛r genast litet tryggare att koda JavaScript n칛r det i princip 칛r om칬jligt att drifts칛tta ej kvalitetss칛krad kod.</p><p>D친 <a href=http://csslint.net>CSSLint</a> ocks친 ligger i Node.js skulle 칛ven den bli en kandidat f칬r version 2. Efter det kvarst친r bara HTML-valideringen, vilket jag dock ser liten po칛ng med att validera s친 strikt: d칛r r칛cker troligen mina ant-targets tillsammans med ett CI-system.</p></article></main><aside><h2 class=h--aside>Senaste inl칛ggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad ber칛ttar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>G칛rning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varf칬r och hur jag ska f칬rdjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/elixir>Varf칬r och hur jag ska fokusera p친 att l칛ra mig Elixir 2019</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, G칛vle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jarom캩콏</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2012-09-11</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr칬m sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>