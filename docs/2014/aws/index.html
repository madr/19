<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Hackad pÃ¥ AWS - en snabb redogÃ¶relse | Anders YtterstrÃ¶ms hemsida</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=/madrse.css><link href=/prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2014/aws/ ><meta property=og:title content="Hackad pÃ¥ AWS - en snabb redogÃ¶relse"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2014/aws/ ><meta property=og:image content=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276><meta property=og:site_name content="Anders YtterstrÃ¶ms hemsida"></head><body><a href=#content class=skiplink>Hoppa till innehÃ¥ll</a><header><a href=/ rel=home>madr.se</a><nav><a href=/bl/ >ğŸ¤˜ BrÃ¼tal Legend</a> <a href=/evenemang/ >ğŸ“… Evenemang</a> <a href=/om/ >ğŸ¤·â€â™‚ï¸ Om</a> <a href=/prenumerera.xml rel=alternate title="Prenumerera via Atom">ğŸ“£</a></nav></header><main id=content><article><h1>Hackad pÃ¥ AWS - en snabb redogÃ¶relse</h1><footer><time>2014-10-08</time> av <a rel=author href=/om><img src=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276 alt=portrÃ¤tt> Anders YtterstrÃ¶m</a></footer><p>SÃ¥, fÃ¶ljande har hÃ¤nt:</p><ol><li>Under september mÃ¥nad kapades mitt konto pÃ¥ Amazon Web Services (AWS).</li><li><strong>Onsdagen den 24 september</strong> ombads jag av ett mail frÃ¥n AWS att byta lÃ¶senord, ta bort mina sÃ¤kerhetsnycklar och se om nÃ¥got konstigt fanns pÃ¥ mitt konto.</li><li><strong>Fredagen den 26 september</strong> fick jag ett telefonsamtal frÃ¥n AWS support dÃ¤r de upplyste mig om att jag blivit utsatt fÃ¶r intrÃ¥ng pÃ¥ EC2 och hur jag kunde logga in och stÃ¤nga ner de av mig ej skapade tjÃ¤nsterna, samt hur jag skulle driva detta vidare. Det var nÃ¤r jag gjorde detta som jag fick se vad intrÃ¥nget stÃ¤llt till med - Ec2-missbruk fÃ¶r ungefÃ¤r $18.000.</li><li>Samma fredag, efter Ã¥tgÃ¤rderna telefonsamtalet innehÃ¶ll vidtagits, mailar jag Amazon och skriver om hela hÃ¤ndelsefÃ¶rloppet.</li><li><strong>SÃ¶ndagen den 28 september</strong> fÃ¥r jag ytterligare instruktioner om att fÃ¶rsÃ¤kra mig om att allt intrÃ¥nget skapat verkligen Ã¤r avstÃ¤ngt. I samband med detta skapades ett Ã¤rende i deras Support center.</li><li>FrÃ¥n 29 september till 2 oktober uppdaterar Amazon mig via Ã¤rendet. Deras ambition Ã¤r att se till att jag inte behÃ¶ver betala nÃ¥got av de $18.000 som intrÃ¥nget orsakade.</li><li>Idag, den 8 oktober, blev det klart att jag inte behÃ¶ver betala nÃ¥got.</li></ol><p>NÃ¥gra frÃ¥gor som jag hÃ¤r ska besvara:</p><p><strong>Hur fick hackern tillgÃ¥ng till mitt konto?</strong><br>Mitt lÃ¶senord och mina sÃ¤kerhetsnycklar Ã¤r autogenererat och unikt fÃ¶r AWS. Det ligger sparat i en lÃ¶senordsfil som ligger pÃ¥ Dropbox med tvÃ¥stegsverifiering pÃ¥slaget. Tisdagen den 23 september rÃ¥kade jag dÃ¤remot av misstag pusha upp mina sÃ¤kerhetsnycklar till ett publikt repo pÃ¥ Github. Jag upptÃ¤ckte detta ett par timmar senare och tog genast bort hela repot. Min misstanke Ã¤r att en bot lyckades komma Ã¶ver dem under den tidsramen.</p><p><strong>Vad bestod intrÃ¥nget av?</strong><br>20 maxade EC2-instanser per region (Ã¥tta stycken), samt ytterligare nÃ¥gra i Spot Request Queue (dessa var kÃ¶ade fÃ¶r en plats i sin region). Samtliga dessa skapades innan jag bytte lÃ¶senord pÃ¥ onsdagen den 24 september och ingenting mer skapades efter det. Jag upptÃ¤ckte dock inte EC2-maskinerna fÃ¶rrÃ¤n samtalet pÃ¥ fredagen den 26 september dÃ¥ jag inte anvÃ¤nde EC2 och dÃ¤rfÃ¶r inte tÃ¤nkte pÃ¥ att kika dÃ¤r i och med att jag blev ombedd att byta lÃ¶senord pÃ¥ onsdagen.</p><p><strong>Hur hanterade AWS det hela?</strong><br>I mina Ã¶gon flÃ¤ckfritt - de uppdaterade mig lÃ¶pande och var de som tog kontakt med mig sÃ¥ snart de misstÃ¤nkte intrÃ¥ng, via sÃ¥vÃ¤l mail som telefon. De var ocksÃ¥ snabba med att starta en utredning och var frÃ¥n bÃ¶rjan instÃ¤llda pÃ¥ att detta inte skulle debiteras mig. Deras instruktioner till mig var tydliga och pedagogiska, och jag kunde snabbt reagera pÃ¥ de Ã¥tgÃ¤rder som var Ã¥lagda mig.</p><h2 id=l-rdomarna>LÃ¤rdomarna</h2><ul><li>Skriv <strong>aldrig</strong> AWS-sÃ¤kerhetsnyckeln direkt i kod - ens i de minsta snabbhacken! HÃ¥ll det borta med nolltolerans sÃ¥ hamnar det aldrig i nÃ¥gon versionshantering av misstag. I mitt fall var det nÃ¥gra rader JavaScript jag fuskade ihop pÃ¥ en lunchrast. Knappast vÃ¤rt det fÃ¶r att utsÃ¤tta sig sjÃ¤lv fÃ¶r risken att bi utsatt fÃ¶r intrÃ¥ng.</li><li>SÃ¤tt upp ett <strong>billing alarm</strong> pÃ¥ AWS - det hade jag inte gjort, och det hade besparat mig den lÃ¥nga tiden innan jag kunde reagera. Numera har jag ett billing alarm pÃ¥ $1 som kommer att spamma mig sÃ¥ snart nÃ¥got drar ivÃ¤g pÃ¥ AWS.</li></ul></article></main><footer><p><a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders YtterstrÃ¶m sedan dec 2006. <a rel=alternate href=/prenumerera.xml>Prenumerera</a>.</p></footer></body></html>