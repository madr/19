<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Två JavaScriptförbättringar jag inte klarar mig utan | Skrivna ord av Anders Ytterström.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2009/118/ ><meta property=og:title content="Två JavaScriptförbättringar jag inte klarar mig utan"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2009/118/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterström."></head><body><a href=#content class=skiplink>Hoppa till innehåll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders är en webbutvecklare och hårdrockare som gillar brädspel, kaffe och öl. <a href=../../om/ rel=author>Om Anders Ytterström</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >🤘 Brütal Legend</a> <a class=nav__item href=../../evenemang/ >📅 Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >🎲 Brädspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >🦾 Styrketräning</a></nav></header><main id=content><p class=alert--archived><i>Detta är ett arkiverat inlägg, som importerats hit för referens. Det kan se konstigt ut och innehålla utdaterad information eller inaktuella åsikter.</i></p><article><h1>Två JavaScriptförbättringar jag inte klarar mig utan</h1><p>Låt oss enas om en sak: JavaScript som ensam enhet har ibland hål i sina implementationer. När ett sådant hål stöts på kan man välja att fly eller att täppa till hålet. Jag delar här med mig av två åtgärder som gör JavaScript-utveckling litet mer angenämt.</p><p>I båda fallen utökas prototyper med nya egenskaper istället för att skapa en global funktion.</p><h2>String.chunk()</h2><p>Chunks innebär i sammanhanget att en stor mängd delas upp i mindre, mer lätthanterliga mängder. Jag får ibland det behovet med strängar, där jag tex vill sätta mellanslag i 1250500kr för att göra summan mer lättläst.</p><p>Följande kodrader ger oss den möjligheten:</p><pre><code>String.prototype.chunk = function(n) {
  if (typeof n=='undefined') n=2;
  return this.match(RegExp('.{1,'+n+'}','g'));
};
</code></pre><p>Då detta är en funktion som ska funka till strängar är det klokt att lägga funktionen till String-objektets prototype istället för att göra det till en global funktion. Det gör scriptandet mer konsekvent och placerar funktionen till rätt forum.</p><p>Plockas ettan ut i talet 1250500kr går det att stoppa in mellanslagen mycket rättframt.</p><pre><code>var price = '1250500';
price = price.charAt(0) + ' ' + price.slice(1).chunk(3).join(' ');
</code></pre><h2>Date.getWeek()</h2><p>Date-objektet har en del trevliga egenskaper mot ett angivet datum. Objektet fattas dock stöd för att plocka ut aktuell vecka på ett år. Jag har stött på det behovet ett antal gånger, då särskilt när jag utvecklat badges med veckointervall.</p><p>Det är dock inte kärnfysik att få till en kompletterande funktion.</p><pre><code>Date.prototype.getWeek = function() {
var onejan = new Date(this.getFullYear(),0,1);
return Math.ceil((((this - onejan) / 86400000) + onejan.getDay())/7);
}
</code></pre><p>Återigen, det finns inget skäl att lägga en sådan funktion globalt. Den kommer inte att funka på något annat än datum och blir därför en metod i Date-objektets prototype, vilket gör det konsekvent att använda.</p><pre><code>var today = new Date();
alert(today.getWeekDay()); // 1
alert(today.getWeek());    // 14
</code></pre><p>Scripten kan anropas när som helst, men lämpar sig troligtvis bäst längst upp i en JS-fil som anropas tidigt.</p></article></main><aside><h2 class=h--aside>Senaste inläggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad berättar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>Gärning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varför och hur jag ska fördjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/elixir>Varför och hur jag ska fokusera på att lära mig Elixir 2019</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, Gävle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jaroměř</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2009-04-09</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterström sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>