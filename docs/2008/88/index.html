<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Javascript-utveckling, my take | Anders Ytterstr√∂ms hemsida</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=/madrse.css><link href=/prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2008/88/ ><meta property=og:title content="Javascript-utveckling, my take"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2008/88/ ><meta property=og:image content=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276><meta property=og:site_name content="Anders Ytterstr√∂ms hemsida"></head><body><a href=#content class=skiplink>Hoppa till inneh√•ll</a><header><a href=/ rel=home>madr.se</a><nav><a href=/bl/ >ü§ò Br√ºtal Legend</a> <a href=/evenemang/ >üìÖ Evenemang</a> <a href=/om/ >ü§∑‚Äç‚ôÇÔ∏è Om</a> <a href=http://broken-close-swan.gigalixirapp.com/live>üé≤ RISK</a> <a href=/prenumerera.xml rel=alternate title="Prenumerera via Atom">üì£</a></nav></header><main id=content><p class=alert--archived><i>Detta √§r ett arkiverat inl√§gg, som importerats hit f√∂r referens. Det kan se konstigt ut och inneh√•lla utdaterad information eller inaktuella √•sikter.</i></p><article><h1>Javascript-utveckling, my take</h1><footer><time>2008-07-27</time> av <a rel=author href=/om><img src=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276 alt=portr√§tt> Anders Ytterstr√∂m</a></footer><p>Att utveckla JavaScript √§r en balansg√•ng p√• brinnande lina. JavaScript kan g√∂ra fantastiska skillnader i anv√§ndbarhet, och ingen ska vara r√§dd f√∂r att neka sina webbapplikationer s√•dant. Samtidigt √§r kraven p√• kvalitet h√∂gre √§n n√•gonsin: Genv√§gar kan g√∂ra googles spindlar ledsna, script som inte fungerar i vissa webbl√§sare skapar frustration och miss√§mja, och l√•nga laddningstider √§r det aldrig n√•gon som gillat.</p><p>Jag t√§nkte d√§rf√∂r mycket kort skriva ner mina JavaScript-vanor, i hopp om att det hj√§lper n√•gon.</p><h2 id=f-rst-hur-det-inte-ska-se-ut>F√∂rst: hur det inte ska se ut</h2><p>N√§r JavaScript googlas p√• inneh√•ller m√•nga nyb√∂rjartutorials nedanst√•ende exempel.</p><ol><li><code>Tjohej!</code></li><li><code>Tjohej!</code></li><li><code>&lt;form action=&quot;&quot; onsubmit=&quot;foobar()&quot;&gt; ... &lt;/a&gt;</code></li><li><code>&lt;input type=&quot;text&quot; onchange=&quot;foobar()&quot;&gt;</code></li><li><code>// och s√• vidare</code></li></ol><p>Det √§r sorgligt att s√•dana d√•liga exempel ska synas mest f√∂r alla som vill l√§ra sig g√∂ra h√§ftiga webbplatser. L√§nkar med felaktigt <code>href</code> (protokollet <code>javascript</code> existerar inte) g√∂r googles spindlar f√∂rvirrade och kan p√•verka s√∂kplaceringar i st√∂rre omfattningar. Bland webbutvecklare √§r det sett som d√•lig sed att anv√§nda <code>style</code>-attributet p√• HTML-element, f√∂r att det skapar spaghettikod och blir sv√•rare att hantera i l√•nga loppet. Av samma sk√§l h√∂r varken <code>onclick</code>, <code>onchange</code> eller liknande hemma i HTMLdokument.</p><h2 id=lugn-det-finns-b-ttre->Lugn, det finns b√§ttre!</h2><p>Det jag talar om √§r en filosofi som heter <a href=http://en.wikipedia.org/wiki/Unobtrusive_JavaScript>Unobtrusive JavaScript</a>, som grovt g√•r ut p√• att gr√§nssnitt har tre lager:</p><p>Semantik och disposition av inneh√•ll : HTML och XHTML</p><p>Presentation och design : CSS</p><p>Interaktivitet och respons : JavaScript</p><p>JavaScript √§r ett lager i sig sj√§lvt, som ska arbeta frist√•ende fr√•n de andra tv√• (undre) lagren. Rent praktiskt ser det ut s√• h√§r:</p><ol><li><code>window.onload = function()</code></li><li><code>{</code></li><li><code>var lnk = document.getElementsByTagName(&#39;a&#39;);</code></li><li><code>lnk.onclick = foobar;</code></li><li><code></code></li><li><code>var frm = document.getElementsByTagName(&#39;form&#39;);</code></li><li><code>frm.onsubmit = foobar;</code></li><li><code></code></li><li><code>var inpt = document.getElementsByTagName(&#39;input&#39;);</code></li><li><code>inpt.onchange = foobar;</code></li><li><code>}</code></li></ol><p>Det enda sp√•ret vi ser av detta √§r en <code>script</code> i <code>head</code>:</p><ol><li><code>&lt;html&gt;</code></li><li><code>&lt;head&gt;</code></li><li><code>&lt;title&gt;Exempelsida&lt;/title&gt;</code></li><li><code>...</code></li><li><code>&lt;script src=&quot;foobar.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</code></li><li><code>&lt;/head&gt;</code></li><li><code>...</code></li><li><code>&lt;html&gt;</code></li></ol><p>Hemligheten ligger i <code>window.onload</code>. Den k√∂rs varje g√•ng en sida har laddats. Det ovanst√•ende kod g√∂r √§r att leta upp HTML-element via <a href=http://www.w3schools.com/htmldom/dom_obj_document.asp>DOM</a> och tilldela dessa h√§ndelselyssnare. Det finns otaliga b√§ttre s√§tt att g√∂ra det p√• √§n jag g√∂r, men principen √§r densamma: JavaScript initieras av JavaScript, ej av HTML.</p><h2 id=tj-stestrukturerade-script>Tj√§stestrukturerade script</h2><p>Med ovanst√•ende i √•tanke kan jag g√• vidare med hur jag brukar g√∂ra f√∂r att enkelt kunna hitta i mina (till slut gigantiska) JavaScript-filer. Jag b√∂rjar alltid med att skissa p√• vad jag ska scripta, och delar in dessa i <em>tj√§nster</em> och <em>delade egenskaper</em>.</p><p>Tj√§nst : Kan vara en blogg, kontaktsida, kalender eller n√•got annat som bildar en del av ett dokument.</p><p>Delade egenskaper : Kan vara toggle-funktioner, tooltips, formul√§rwidgets eller annat som delas av flera tj√§nster.</p><p>Utifr√•n det anv√§nder jag JavaScriptobjekt f√∂r att skapa egna scopes. Ett typiskt objekt brukar se ut s√• h√§r f√∂r mig:</p><p><strong>cn</strong> (objekt) : St√•r f√∂r "classnames", men inneb√§r mer √§n s√•. H√§r skriver jag upp alla klassnamn, id och elementnamn som jag beh√∂ver f√∂r att s√∂ka igenom DOM-tr√§det. N√§r jag vill ha bloggens wrapper (omslutande element) skriver jag <code>this.cn.wrp</code> eller <code>Blog.cn.wrp</code>.</p><p><strong>labels</strong> (objekt) : Om jag skapar nya element med script, ska l√§nktexter, knapptexter et cetera st√• h√§r f√∂r att underl√§tta hantering.</p><p><strong>Exists</strong> (function : bool) : Funktionen letar igenom DOM-tr√§det efter instanser av tj√§nsten, och returnerar en bool (sant/falskt).</p><p><strong>init</strong> (function : void) : Applicerar script p√• tj√§nsten.</p><ol><li><code>var Blog = new Object();</code></li><li><code>Blog.cn = new Object();</code></li><li><code>Blog.cn.wrp = &quot;blogWrapper&quot;;</code></li><li><code>Blog.cn.wrp = &quot;blogEntries&quot;;</code></li><li><code>Blog.labels = new Object();</code></li><li><code>Blog.labels.toggle = &quot;visa hela&quot;;</code></li><li><code>Blog.exists = function(){ //finns? };</code></li><li><code>Blog.init = function(){ //starta };</code></li></ol><p>Jag f√∂redrar dock ist√§llet kortvarianten f√∂r att det √§r mer l√§sbart:</p><ol><li><code>var Blog = {</code></li><li><code>cn : {</code></li><li><code>wrp : &quot;blogWrapper&quot;,</code></li><li><code>entry : &quot;blogEntries&quot;</code></li><li><code>},</code></li><li><code>labels : {</code></li><li><code>toggle : &quot;visa hela&quot;</code></li><li><code>}</code></li><li><code>exists : function(){</code></li><li><code>//finns?</code></li><li><code>},</code></li><li><code>init : function(){</code></li><li><code>//starta</code></li><li><code>}</code></li><li><code>}</code></li></ol><p>Till detta kompletterar jag med en funktion som brukar ha "prepare" som prefix, en sk <em>invoke</em>:</p><ol><li><code>window.onload = function() {</code></li><li><code>prepareBlog();</code></li><li><code>};</code></li><li><code></code></li><li><code>function prepareBlog() {</code></li><li><code>if(Blog.exists()) {</code></li><li><code>Blog.init();</code></li><li><code>}</code></li><li><code>}</code></li></ol><p>I den anonyma funktionen l√§ggs alla tj√§nsters invokes efter varandra f√∂r att exekvera p√• sidan. Ett annat s√§tt √§r att l√•ta <code>Blog.init</code> k√∂ra <code>Blog.exists</code> internt och avbryta om falskt ist√§llet f√∂r att skapa en ny funktion f√∂r det, men det √§r som man sj√§lv vill.</p><h2 id=nog-f-r-idag>Nog f√∂r idag</h2><p>Jag √§r inte riktigt f√§rdig √§nnu. Det √•terst√•r litet pill till innan jag √§r klar med mina rutiner. Mer om detta kommer i en senare blogg om √§mnet.</p><p>Vidare l√§sning</p><ul><li><a href=http://accessites.org/site/2007/02/graceful-degradation-progressive-enhancement/ >Progressive Enhancement och Graceful Degradation</a>.</li><li><a href=http://www.domscripting.com>DOM scripting</a> av Jeremy Keith, en bok om javascript p√• r√§tt s√§tt.</li><li><a href="http://www.sitepoint.com/books/javascript1/?SID=e419041e974800ccd8cb6fc89cf7a358">Simply JavaScript</a> av Cameron Adams och Kevin Yank, en annan bok om javascript p√• r√§tt s√§tt.</li></ul></article></main><footer><p><a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr√∂m sedan dec 2006. <a rel=alternate href=/prenumerera.xml>Prenumerera</a>.</p></footer></body></html>