<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Leker med DOMDocument | Skrivna ord av Anders Ytterstr칬m.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2007/27/ ><meta property=og:title content="Leker med DOMDocument"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2007/27/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterstr칬m."></head><body><a href=#content class=skiplink>Hoppa till inneh친ll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders 칛r en webbutvecklare och h친rdrockare som gillar br칛dspel, kaffe och 칬l. <a href=../../om/ rel=author>Om Anders Ytterstr칬m</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >游뱆 Br칲tal Legend</a> <a class=nav__item href=../../evenemang/ >游늰 Evenemang</a></nav></header><main id=content><p class=alert--archived><i>Detta 칛r ett arkiverat inl칛gg, som importerats hit f칬r referens. Det kan se konstigt ut och inneh친lla utdaterad information eller inaktuella 친sikter.</i></p><article><h1>Leker med DOMDocument</h1><p>M친nga utav de klasser som utg칬r Madr webbapplikation skall skrivas om inom en snar framtid. En av de delar jag aldrig varit riktigt n칬jd med 칛r hur mina kontrollerare behandlar datatransport fr친n modellagret till vylagret.</p><p>Min mallmotor (template engine) 칛r transformsbaserad, och bygger p친 XSL via klassen XSLTPRocessor. D친 XSLTPRocessor-objektet tar emot ett DOM-dokument som argument f칬r att generera HTML, m친ste modellagrets datasamling f칬rvandlas till ett s친dant. Min nuvarande l칬sning p친 detta 칛r verkligen f칬rskr칛cklig:</p><ol><li>Beg칛r en n칛stlad vektor fr친n modellen till kontrolleraren.</li><li>n칛stla vektorn 칛nnu mer f칬r att all data skall f친 plats.</li><li>Initiera vy-objektet med vektorn som argument.</li><li>Importera vektorn till ett DOM-dokument via DomBuilder::import($data). alla nummernycklar byts ut mot &quot;rs&quot;.\</li><li>Exportera och importera DOM-dokumentet igen f칬r att leka litet med HTML_entities_decode() och HTML_entities() f칬r att allt skall se bra ut.</li><li>Transformera och skriv ut HTML.\</li></ol><p>En ful och mycket otrevlig l칬sning att arbeta med. DOM-dokumentet som generas av ovanst친ende algoritm 칛r helt befriade fr친n logisk och semantisk struktur, vilket g칬r det mer komplicerat 칛n 칬nskv칛rt att skapa XSL-mallar till el칛ndet.</p><p>Anledningen till att det blivit s친h칛r 칛r att jag vid implementations tidpunkt inte hade en aning om hur att bem칛stra DOM. S친 칛r inte fallet idag. Jag skall d칛rf칬r 친terimplementera hela l칬sningen med ett globalt DOM-dokument. Datamodellen skall inte 친ters칛nda vektorer, utan en elementnod med barnnoder som importeras direkt till det globala DOM-dokumentet. N칛r mallmotorn sedan skall transformera beh칬vs ingen l칬jlig importering, plus att DOM-dokumentets struktur 칛r intakt och semantisk.</p><p>Jag satt idag och lekte med detta, d친 jag provade blanda tv친 importtekniker: Vektor till DOM, och extern XML-fil till DOM. Detta finns uppe i mitt labarkiv:\</p><ul><li><a href=http://src.madr.se/php/dom/dom.php>Import till DOMDocument</a></li><li><a href=http://src.madr.se/php/dom/dom.phps>K칛llkod</a></li></ul></article></main><aside><h2 class=h--aside>Senaste inl칛ggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad ber칛ttar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>G칛rning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varf칬r och hur jag ska f칬rdjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/elixir>Varf칬r och hur jag ska fokusera p친 att l칛ra mig Elixir 2019</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, G칛vle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jarom캩콏</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2007-05-27</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr칬m sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>.</p></footer></body></html>