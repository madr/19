<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Indexinkludering och adressf칛ltet | Skrivna ord av Anders Ytterstr칬m.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2007/41/ ><meta property=og:title content="Indexinkludering och adressf칛ltet"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2007/41/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterstr칬m."></head><body><a href=#content class=skiplink>Hoppa till inneh친ll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders 칛r en webbutvecklare och h친rdrockare som gillar br칛dspel, kaffe och 칬l. <a href=../../om/ rel=author>Om Anders Ytterstr칬m</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >游뱆 Br칲tal Legend</a> <a class=nav__item href=../../evenemang/ >游늰 Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >游 Br칛dspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >游 Styrketr칛ning</a></nav></header><main id=content><p class=alert--archived><i>Detta 칛r ett arkiverat inl칛gg, som importerats hit f칬r referens. Det kan se konstigt ut och inneh친lla utdaterad information eller inaktuella 친sikter.</i></p><article><h1>Indexinkludering och adressf칛ltet</h1><p>De senaste 친ren har det varit trendigt med indexinkludering i webbutvecklingssammanhang. Det finns en klar f칬rdel med att g칬ra detta, eftersom globala konventioner och inst칛llningar g칬rs en g친ng ist칛llet f칬r flera. En nackdel 칛r att det finns m친nga fallgropar, s칛rskilt f칬r nyb칬rjare d칛r det kan g친 fel. Vanligaste misstaget 칛r att HTML-utskriften sker selektivt: index.php inkluderar f칬rst filen ./header.php och sedan <code>($_GET['page']).php</code>. Om den unika sidan misslyckas att skriva ut bem칬ts anv칛ndaren av ett sidhuvud och ett kryptiskt felmeddelande n친gonstans p친 sk칛rmen, vilket 칛r alltifr친n 칬nskv칛rt.</p><p>Vid anv칛ndning av t ex mallar och vyer 칛r detta problem dock eliminerat, eftersom HTML-dokumentet kommer i en enda str칬m ist칛llet f칬r flera selektiva. Och problemet jag nyss beskrev 칛r inte specifikt f칬r applikationer med indexinkludering. Ett problem som d칛remot 칛r en direkt verkan, och ett h칬gst viktigt problem att ta itu med 칛r det h칛r:</p><p><a href="http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28">http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28</a></p><p>Med indexinkludering blir det en massa parametrar som m친ste skickas efter fr친getecknet. En vanlig bes칬kare ser detta som en enda l친ng kryptisk kedja och visar med stor s칛kerhet inget intresse f칬r den. Sj칛lv tycker jag om att kunna navigera direkt med adressf칛ltet, och jag f칬rest칛ller mig att jag inte 칛r ensam om att vilja det. Adressf칛ltet 칛r ett verktyg som finns i webbl칛sare, precis som bak친t- och fram친tknapparna, och den 칛r mest dominant sett till dess storlek. Det 칛r farligt att neka anv칛ndare anv칛ndbarhet.</p><p>Indexinkludering st칛ller till det f칬r gr칛nssnittet.</p><p>Den absolut b칛sta l칬sningen p친 problemet om man har Apache eller IIS 칛r att anv칛nda en omskrivningsmodul. I Apache heter denna <em>mod_rewrite</em>. Ovanst친ende adress kan d친 skrivas om till</p><p><a href=http://madr.se/webblogg/2007/8/28>http://madr.se/webblogg/2007/8/28</a></p><p>Vilket 칛r betydligt mer semantiskt och anv칛ndarv칛nligt. Vill en anv칛ndare kika p친 inl칛gg fr친n 5:e september g친r det att 칛ndra direkt i adressf칛ltet.</p><p>Men omskrivningsmoduler g친r aldrig att r칛kna med. De kr칛ver plattformsspecifik konfiguation, b친de i webbapplikationerna och p친 webservern. Det kr칛ver ocks친 litet inl칛rning. En applikation som fungerar p친 utvecklingsservern som 칛r Apache har ingen garanti att fungera om den skall anv칛ndas p친 en publik IIS-server. Ett webbhotell har ocks친 makten att neka kunder s친dana moduler f칬r deras s칛kerhetspolicies (har sett s친dant h칛nda f칬r 'mindre' saker 칛n omskrivningsmoduler).</p><p>S친vida man inte har en egen server eller 100% koll 칛r det allts친 en risk att f칬rlita sig p친 omskrivningsmoduler. Vad finns det f칬r alternativ d친, f칬r att r친da bukt p친 det tr친kiga adressf칛ltet?</p><p>Faktum 칛r att jag i detta fall predikar om att g친 tillbaka till enkelhet. L친t alla sidor ligga i egna filer. V친r testsida skulle i s친 fall se ut s친h칛r:</p><p><a href="http://madr.se/webblogg/arkiv.php?date=2007-08-28">http://madr.se/webblogg/arkiv.php?date=2007-08-28</a></p><p>V친r sidas adress har inte lika tv칛tts칛ker semantik som med omskrivningsmoduler, men det 칛r betydligt b칛ttre. Dessutom 칛r implementationen s친 enkel att den garanterat fungerar 칬verallt d칛r st칬d f칬r PHP finns. Det g친r fortfarande att hantera utskrift med vyer, det g친r fortfarande att skriva komplexa MVC:er och till칛mpa designm칬nster, eftersom varje fil agerar som kontrollerare. De procedurer som index.php inneh친ller i sammanhanget vid indexinkludering kan med f칬rdel flyttas ut till en egen fil som inkluderas av varje kontrollerare. Det handlar om ett f친tal rader extra kod.</p><p>Faktum 칛r att jag suttit och lekt med just detta till MWA, som agerar skelett 친t den h칛r webbplatsen. Jag ville ha ett skalbart MVC d칛r det skulle g친 att skifta mellan anv칛ndande av frontcontroller i index.php och fallet med en fil f칬r varje kontrollerare.</p><p>I min implementation finns det tv친 frontcontrollers f칬r indexinkludering, d칛r den enda 칛r beroende av mod_rewrite och den andra inte. B친da implementerar <code>madr_interface_frontcontroller</code> och sk칬ter litet inputvalidering och annat ut칬ver att inkludera en kontrollerar-fil.</p><p>Konstanter och andra viktiga faktorer f칬r k칬rning ligger i init.php, som inkluderas p친 f칬rsta raden.</p><p>Min filstruktur:</p><ul><li>/cache</li><li>/controller/pages</li><li>/controller/scripts</li><li>/lib</li><li>/log</li><li>/model</li><li>/public</li><li>/view</li></ul><p>Jag lyckades uppn친 s친dan skalbarhet att jag endast beh칬vde flytta kontrollerarna fr친n controllers/pages och /controllers/scripts till /public, den enda katalogen som n친s utifr친n(normalt ligger endast index.php d칛r). I varje kontrollerare lade jag till</p><p><code>require '../lib/init.php'</code></p><p>칬verst och i de kontrollerare som 칛r 'pages' lade jag till</p><p><code>$view = new madr_view($vyfilens_namn); $view-&gt;compile();</code></p><p>sist i koden, d친 detta normalt s칛tt sk칬ts av ett madr_controller objekt f칬r mig. Och bevare mig v칛l, det fungerade. Jag 칛r n칬jd. :)</p><p>Nu n칛r jag slagit mig sj칛lv i ryggen litet f칬r att jag 칛r s친 bra(;p), s친 reflektera litet 칬ver mina tankar. Blir allt verkligen 'snyggare' och 'enklare' med indexinkludering?</p></article></main><aside><h2 class=h--aside>Senaste inl칛ggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad ber칛ttar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>G칛rning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varf칬r och hur jag ska f칬rdjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/brutallegend-17>Angel Witch - Angel Witch #bl17</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, G칛vle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jarom캩콏</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2007-08-20</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr칬m sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>