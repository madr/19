<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Indexinkludering och adressfältet | Skrivna ord av Anders Ytterström.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2007/41/ ><meta property=og:title content="Indexinkludering och adressfältet"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2007/41/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterström."></head><body><a href=#content class=skiplink>Hoppa till innehåll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders är en webbutvecklare och hårdrockare som gillar brädspel, kaffe och öl. <a href=../../om/ rel=author>Om Anders Ytterström</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../bl/ >🤘 Brütal Legend</a> <a class=nav__item href=../../evenemang/ >📅 Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >🎲 Brädspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >🦾 Styrketräning</a></nav></header><main id=content><p class=alert--archived><i>Detta är ett arkiverat inlägg, som importerats hit för referens. Det kan se konstigt ut och innehålla utdaterad information eller inaktuella åsikter.</i></p><article><h1>Indexinkludering och adressfältet</h1><p>De senaste åren har det varit trendigt med indexinkludering i webbutvecklingssammanhang. Det finns en klar fördel med att göra detta, eftersom globala konventioner och inställningar görs en gång istället för flera. En nackdel är att det finns många fallgropar, särskilt för nybörjare där det kan gå fel. Vanligaste misstaget är att HTML-utskriften sker selektivt: index.php inkluderar först filen ./header.php och sedan <code>($_GET['page']).php</code>. Om den unika sidan misslyckas att skriva ut bemöts användaren av ett sidhuvud och ett kryptiskt felmeddelande någonstans på skärmen, vilket är alltifrån önskvärt.</p><p>Vid användning av t ex mallar och vyer är detta problem dock eliminerat, eftersom HTML-dokumentet kommer i en enda ström istället för flera selektiva. Och problemet jag nyss beskrev är inte specifikt för applikationer med indexinkludering. Ett problem som däremot är en direkt verkan, och ett högst viktigt problem att ta itu med är det här:</p><p><a href="http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28">http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28</a></p><p>Med indexinkludering blir det en massa parametrar som måste skickas efter frågetecknet. En vanlig besökare ser detta som en enda lång kryptisk kedja och visar med stor säkerhet inget intresse för den. Själv tycker jag om att kunna navigera direkt med adressfältet, och jag föreställer mig att jag inte är ensam om att vilja det. Adressfältet är ett verktyg som finns i webbläsare, precis som bakåt- och framåtknapparna, och den är mest dominant sett till dess storlek. Det är farligt att neka användare användbarhet.</p><p>Indexinkludering ställer till det för gränssnittet.</p><p>Den absolut bästa lösningen på problemet om man har Apache eller IIS är att använda en omskrivningsmodul. I Apache heter denna <em>mod_rewrite</em>. Ovanstående adress kan då skrivas om till</p><p><a href=http://madr.se/webblogg/2007/8/28>http://madr.se/webblogg/2007/8/28</a></p><p>Vilket är betydligt mer semantiskt och användarvänligt. Vill en användare kika på inlägg från 5:e september går det att ändra direkt i adressfältet.</p><p>Men omskrivningsmoduler går aldrig att räkna med. De kräver plattformsspecifik konfiguation, både i webbapplikationerna och på webservern. Det kräver också litet inlärning. En applikation som fungerar på utvecklingsservern som är Apache har ingen garanti att fungera om den skall användas på en publik IIS-server. Ett webbhotell har också makten att neka kunder sådana moduler för deras säkerhetspolicies (har sett sådant hända för 'mindre' saker än omskrivningsmoduler).</p><p>Såvida man inte har en egen server eller 100% koll är det alltså en risk att förlita sig på omskrivningsmoduler. Vad finns det för alternativ då, för att råda bukt på det tråkiga adressfältet?</p><p>Faktum är att jag i detta fall predikar om att gå tillbaka till enkelhet. Låt alla sidor ligga i egna filer. Vår testsida skulle i så fall se ut såhär:</p><p><a href="http://madr.se/webblogg/arkiv.php?date=2007-08-28">http://madr.se/webblogg/arkiv.php?date=2007-08-28</a></p><p>Vår sidas adress har inte lika tvättsäker semantik som med omskrivningsmoduler, men det är betydligt bättre. Dessutom är implementationen så enkel att den garanterat fungerar överallt där stöd för PHP finns. Det går fortfarande att hantera utskrift med vyer, det går fortfarande att skriva komplexa MVC:er och tillämpa designmönster, eftersom varje fil agerar som kontrollerare. De procedurer som index.php innehåller i sammanhanget vid indexinkludering kan med fördel flyttas ut till en egen fil som inkluderas av varje kontrollerare. Det handlar om ett fåtal rader extra kod.</p><p>Faktum är att jag suttit och lekt med just detta till MWA, som agerar skelett åt den här webbplatsen. Jag ville ha ett skalbart MVC där det skulle gå att skifta mellan användande av frontcontroller i index.php och fallet med en fil för varje kontrollerare.</p><p>I min implementation finns det två frontcontrollers för indexinkludering, där den enda är beroende av mod_rewrite och den andra inte. Båda implementerar <code>madr_interface_frontcontroller</code> och sköter litet inputvalidering och annat utöver att inkludera en kontrollerar-fil.</p><p>Konstanter och andra viktiga faktorer för körning ligger i init.php, som inkluderas på första raden.</p><p>Min filstruktur:</p><ul><li>/cache</li><li>/controller/pages</li><li>/controller/scripts</li><li>/lib</li><li>/log</li><li>/model</li><li>/public</li><li>/view</li></ul><p>Jag lyckades uppnå sådan skalbarhet att jag endast behövde flytta kontrollerarna från controllers/pages och /controllers/scripts till /public, den enda katalogen som nås utifrån(normalt ligger endast index.php där). I varje kontrollerare lade jag till</p><p><code>require '../lib/init.php'</code></p><p>överst och i de kontrollerare som är 'pages' lade jag till</p><p><code>$view = new madr_view($vyfilens_namn); $view-&gt;compile();</code></p><p>sist i koden, då detta normalt sätt sköts av ett madr_controller objekt för mig. Och bevare mig väl, det fungerade. Jag är nöjd. :)</p><p>Nu när jag slagit mig själv i ryggen litet för att jag är så bra(;p), så reflektera litet över mina tankar. Blir allt verkligen 'snyggare' och 'enklare' med indexinkludering?</p></article></main><aside><h2 class=h--aside>Senaste inläggen</h2><ul class=recents><li class=recents__item><a href=../../2019/meta>Tuffa saker i senaste iterationen av madr.se</a></li><li class=recents__item><a href=../../2019/apps>Vad berättar mina program om mig?</a></li><li class=recents__item><a href=../../2019/ridderligheten>Gärning i ridderlighetens namn</a></li><li class=recents__item><a href=../../2019/react-redux>Varför och hur jag ska fördjupa mig i React 2019</a></li><li class=recents__item><a href=../../2019/brutallegend-17>Angel Witch - Angel Witch #bl17</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Mayhem </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-11-29T00:00:00Z class=upcoming__item__when itemprop=startDate><span>29</span> <span>nov</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wardruna </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-01T00:00:00Z class=upcoming__item__when itemprop=startDate><span>1</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Amon Amarth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Annexet</span>, Stockholm </span><time datetime=2019-12-07T00:00:00Z class=upcoming__item__when itemprop=startDate><span>7</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Fryshuset</span>, Stockholm </span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop=startDate><span>18</span> <span>dec</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Cirkus</span>, Stockholm </span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop=startDate><span>13</span> <span>jan</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Folkoperan</span>, Stockholm </span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>feb</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Gasklockorna</span>, Gävle </span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Wacken</span>, Tyskland </span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span></time></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop=name class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=name>Jaroměř</span>, Tjeckien </span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span></time></li></ul></aside><footer><p>Publicerades <time>2007-08-20</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterström sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>