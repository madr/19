<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Indexinkludering och adressf√§ltet | Skrivna ord av Anders Ytterstr√∂m.</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=../../madrse.css><link href=../../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=stylesheet title="madr.se stilmall" href=../madrse.css><link href=../prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2007/41/ ><meta property=og:title content="Indexinkludering och adressf√§ltet"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2007/41/ ><meta property=og:image content=https://madr.se/mugshot.jpg><meta property=og:site_name content="Skrivna ord av Anders Ytterstr√∂m."></head><body><a href=#content class=skiplink>Hoppa till inneh√•ll</a><header><a href=../../ rel=home><img class=portrait src=../../mugshot.jpg alt="Anders, september 2018."></a><p class=presentation>Anders √§r en webbutvecklare och h√•rdrockare som gillar br√§dspel, kaffe och √∂l. <a href=../../om/ rel=author>Om Anders Ytterstr√∂m</a></p><nav><h2 class=visuallyhidden>Meny</h2><a class=nav__item href=../../1/ >‚úí Inl√§gg</a> <a class=nav__item href=../../bl/ >ü§ò Br√ºtal Legend</a> <a class=nav__item href=../../evenemang/ >üìÖ Evenemang</a> <a class=nav__item href=https://madr.github.io/mybgg/ >üé≤ Br√§dspel</a> <a class=nav__item href=https://madr.github.io/urban-enigma/ >ü¶æ Styrketr√§ning</a></nav></header><main id=content><p class=alert--archived><i>Detta √§r ett arkiverat inl√§gg, som importerats hit f√∂r referens. Det kan se konstigt ut och inneh√•lla utdaterad information eller inaktuella √•sikter.</i></p><article><h1>Indexinkludering och adressf√§ltet</h1><p>De senaste &#xE5;ren har det varit trendigt med indexinkludering i webbutvecklingssammanhang. Det finns en klar f&#xF6;rdel med att g&#xF6;ra detta, eftersom globala konventioner och inst&#xE4;llningar g&#xF6;rs en g&#xE5;ng ist&#xE4;llet f&#xF6;r flera. En nackdel &#xE4;r att det finns m&#xE5;nga fallgropar, s&#xE4;rskilt f&#xF6;r nyb&#xF6;rjare d&#xE4;r det kan g&#xE5; fel. Vanligaste misstaget &#xE4;r att HTML-utskriften sker selektivt: index.php inkluderar f&#xF6;rst filen ./header.php och sedan <code>($_GET[&apos;page&apos;]).php</code>. Om den unika sidan misslyckas att skriva ut bem&#xF6;ts anv&#xE4;ndaren av ett sidhuvud och ett kryptiskt felmeddelande n&#xE5;gonstans p&#xE5; sk&#xE4;rmen, vilket &#xE4;r alltifr&#xE5;n &#xF6;nskv&#xE4;rt.</p><p>Vid anv&#xE4;ndning av t ex mallar och vyer &#xE4;r detta problem dock eliminerat, eftersom HTML-dokumentet kommer i en enda str&#xF6;m ist&#xE4;llet f&#xF6;r flera selektiva. Och problemet jag nyss beskrev &#xE4;r inte specifikt f&#xF6;r applikationer med indexinkludering. Ett problem som d&#xE4;remot &#xE4;r en direkt verkan, och ett h&#xF6;gst viktigt problem att ta itu med &#xE4;r det h&#xE4;r:</p><p><a href="http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28">http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28</a></p><p>Med indexinkludering blir det en massa parametrar som m&#xE5;ste skickas efter fr&#xE5;getecknet. En vanlig bes&#xF6;kare ser detta som en enda l&#xE5;ng kryptisk kedja och visar med stor s&#xE4;kerhet inget intresse f&#xF6;r den. Sj&#xE4;lv tycker jag om att kunna navigera direkt med adressf&#xE4;ltet, och jag f&#xF6;rest&#xE4;ller mig att jag inte &#xE4;r ensam om att vilja det. Adressf&#xE4;ltet &#xE4;r ett verktyg som finns i webbl&#xE4;sare, precis som bak&#xE5;t- och fram&#xE5;tknapparna, och den &#xE4;r mest dominant sett till dess storlek. Det &#xE4;r farligt att neka anv&#xE4;ndare anv&#xE4;ndbarhet.</p><p>Indexinkludering st&#xE4;ller till det f&#xF6;r gr&#xE4;nssnittet.</p><p>Den absolut b&#xE4;sta l&#xF6;sningen p&#xE5; problemet om man har Apache eller IIS &#xE4;r att anv&#xE4;nda en omskrivningsmodul. I Apache heter denna <em>mod_rewrite</em>. Ovanst&#xE5;ende adress kan d&#xE5; skrivas om till</p><p><a href=http://madr.se/webblogg/2007/8/28>http://madr.se/webblogg/2007/8/28</a></p><p>Vilket &#xE4;r betydligt mer semantiskt och anv&#xE4;ndarv&#xE4;nligt. Vill en anv&#xE4;ndare kika p&#xE5; inl&#xE4;gg fr&#xE5;n 5:e september g&#xE5;r det att &#xE4;ndra direkt i adressf&#xE4;ltet.</p><p>Men omskrivningsmoduler g&#xE5;r aldrig att r&#xE4;kna med. De kr&#xE4;ver plattformsspecifik konfiguation, b&#xE5;de i webbapplikationerna och p&#xE5; webservern. Det kr&#xE4;ver ocks&#xE5; litet inl&#xE4;rning. En applikation som fungerar p&#xE5; utvecklingsservern som &#xE4;r Apache har ingen garanti att fungera om den skall anv&#xE4;ndas p&#xE5; en publik IIS-server. Ett webbhotell har ocks&#xE5; makten att neka kunder s&#xE5;dana moduler f&#xF6;r deras s&#xE4;kerhetspolicies (har sett s&#xE5;dant h&#xE4;nda f&#xF6;r &apos;mindre&apos; saker &#xE4;n omskrivningsmoduler).</p><p>S&#xE5;vida man inte har en egen server eller 100% koll &#xE4;r det allts&#xE5; en risk att f&#xF6;rlita sig p&#xE5; omskrivningsmoduler. Vad finns det f&#xF6;r alternativ d&#xE5;, f&#xF6;r att r&#xE5;da bukt p&#xE5; det tr&#xE5;kiga adressf&#xE4;ltet?</p><p>Faktum &#xE4;r att jag i detta fall predikar om att g&#xE5; tillbaka till enkelhet. L&#xE5;t alla sidor ligga i egna filer. V&#xE5;r testsida skulle i s&#xE5; fall se ut s&#xE5;h&#xE4;r:</p><p><a href="http://madr.se/webblogg/arkiv.php?date=2007-08-28">http://madr.se/webblogg/arkiv.php?date=2007-08-28</a></p><p>V&#xE5;r sidas adress har inte lika tv&#xE4;tts&#xE4;ker semantik som med omskrivningsmoduler, men det &#xE4;r betydligt b&#xE4;ttre. Dessutom &#xE4;r implementationen s&#xE5; enkel att den garanterat fungerar &#xF6;verallt d&#xE4;r st&#xF6;d f&#xF6;r PHP finns. Det g&#xE5;r fortfarande att hantera utskrift med vyer, det g&#xE5;r fortfarande att skriva komplexa MVC:er och till&#xE4;mpa designm&#xF6;nster, eftersom varje fil agerar som kontrollerare. De procedurer som index.php inneh&#xE5;ller i sammanhanget vid indexinkludering kan med f&#xF6;rdel flyttas ut till en egen fil som inkluderas av varje kontrollerare. Det handlar om ett f&#xE5;tal rader extra kod.</p><p>Faktum &#xE4;r att jag suttit och lekt med just detta till MWA, som agerar skelett &#xE5;t den h&#xE4;r webbplatsen. Jag ville ha ett skalbart MVC d&#xE4;r det skulle g&#xE5; att skifta mellan anv&#xE4;ndande av frontcontroller i index.php och fallet med en fil f&#xF6;r varje kontrollerare.</p><p>I min implementation finns det tv&#xE5; frontcontrollers f&#xF6;r indexinkludering, d&#xE4;r den enda &#xE4;r beroende av mod_rewrite och den andra inte. B&#xE5;da implementerar <code>madr_interface_frontcontroller</code> och sk&#xF6;ter litet inputvalidering och annat ut&#xF6;ver att inkludera en kontrollerar-fil.</p><p>Konstanter och andra viktiga faktorer f&#xF6;r k&#xF6;rning ligger i init.php, som inkluderas p&#xE5; f&#xF6;rsta raden.</p><p>Min filstruktur:</p><ul><li>/cache</li><li>/controller/pages</li><li>/controller/scripts</li><li>/lib</li><li>/log</li><li>/model</li><li>/public</li><li>/view</li></ul><p>Jag lyckades uppn&#xE5; s&#xE5;dan skalbarhet att jag endast beh&#xF6;vde flytta kontrollerarna fr&#xE5;n controllers/pages och /controllers/scripts till /public, den enda katalogen som n&#xE5;s utifr&#xE5;n(normalt ligger endast index.php d&#xE4;r). I varje kontrollerare lade jag till</p><p><code>require &apos;../lib/init.php&apos;</code></p><p>&#xF6;verst och i de kontrollerare som &#xE4;r &apos;pages&apos; lade jag till</p><p><code>$view = new madr_view($vyfilens_namn); $view-&gt;compile();</code></p><p>sist i koden, d&#xE5; detta normalt s&#xE4;tt sk&#xF6;ts av ett madr_controller objekt f&#xF6;r mig. Och bevare mig v&#xE4;l, det fungerade. Jag &#xE4;r n&#xF6;jd. :)</p><p>Nu n&#xE4;r jag slagit mig sj&#xE4;lv i ryggen litet f&#xF6;r att jag &#xE4;r s&#xE5; bra(;p), s&#xE5; reflektera litet &#xF6;ver mina tankar. Blir allt verkligen &apos;snyggare&apos; och &apos;enklare&apos; med indexinkludering?</p></article></main><aside><h2 class=h--aside>Senaste inl√§ggen</h2><ul class=recents><li class=recents__item><a href=../../2019/fortfarande-sysadmin>Fortfarande sysadmin - jag ger upp linux tills vidare</a></li><li class=recents__item><a href=../../2019/amon-amarth>Amon Amarth: Berserker World Tour</a></li><li class=recents__item><a href=../../2019/wardruna>Wardruna</a></li><li class=recents__item><a href=../../2019/mayhem>Mayhem + support</a></li><li class=recents__item><a href=../../2019/facebook-linkedin-eol>Tack f√∂r tiden, Facebook och LinkedIn</a></li></ul><h2 class=h--aside>Kommande evenemang</h2><ul class=upcoming><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Solstafir </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Fryshuset</span>, Stockholm </span></span><time datetime=2019-12-18T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>18</span> <span>dec</span></time><div class=visuallyhidden itemprop=description><p>Konsert p&#xE5; Fryshuset, Stockholm den 18 december 2019.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>December Darkness </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Dynamo</span>, Norrk√∂ping </span></span><time datetime=2019-12-28T00:00:00Z class=upcoming__item__when itemprop=startDate><span>28</span> <span>dec</span> </time><span class=visuallyhidden itemprop=endDate>Sun Dec 29 2019 01:00:00 GMT+0100 (GMT+01:00)</span><div class=visuallyhidden itemprop=description><p>Endagsfestival p&#xE5; Dynamo, Norrk&#xF6;ping den 28 december 2019.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Opeth </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Cirkus</span>, Stockholm </span></span><time datetime=2020-01-13T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>13</span> <span>jan</span></time><div class=visuallyhidden itemprop=description><p>Konsert p&#xE5; Cirkus, Stockholm den 13 januari 2020.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Coraline </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Folkoperan</span>, Stockholm </span></span><time datetime=2020-02-05T00:00:00Z class=upcoming__item__when itemprop="startDate endDate"><span>5</span> <span>feb</span></time><div class=visuallyhidden itemprop=description><p>F&#xF6;rest&#xE4;llning p&#xE5; Folkoperan, Stockholm den 5 februari 2020.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>House of Metal 14 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Folkets hus</span>, Ume√• </span></span><time datetime=2020-02-28T00:00:00Z class=upcoming__item__when itemprop=startDate><span>28</span> <span>feb</span> </time><span class=visuallyhidden itemprop=endDate>Sat Feb 29 2020 01:00:00 GMT+0100 (GMT+01:00)</span><div class=visuallyhidden itemprop=description><p>Stadsfestival p&#xE5; Folkets hus, Ume&#xE5; den 28-29 februari 2020.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Gefle Metal Festival 4 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Gasklockorna</span>, G√§vle </span></span><time datetime=2020-07-09T00:00:00Z class=upcoming__item__when itemprop=startDate><span>9</span> <span>jul</span> </time><span class=visuallyhidden itemprop=endDate>Sat Jul 11 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description><p>Festival p&#xE5; Gasklockorna, G&#xE4;vle den 9-11 juli 2020.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Wacken Open Air 31 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Wacken</span>, Tyskland </span></span><time datetime=2020-07-30T00:00:00Z class=upcoming__item__when itemprop=startDate><span>30</span> <span>jul</span> </time><span class=visuallyhidden itemprop=endDate>Sat Aug 01 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description><p>Festival i Wacken, Tyskland den 30 juli - 1 augusti 2020.</p></div><span class=visuallyhidden itemprop=address></span></li><li class=upcoming__item itemscope itemtype=http://schema.org/Event><strong itemprop="name performer" class=upcoming__item__what>Brutal Assault 25 </strong><span class=upcoming__item__where itemprop=location itemscope itemtype=http://schema.org/Place><span itemprop=address><span itemprop=name>Jaromƒõ≈ô</span>, Tjeckien </span></span><time datetime=2020-08-05T00:00:00Z class=upcoming__item__when itemprop=startDate><span>5</span> <span>aug</span> </time><span class=visuallyhidden itemprop=endDate>Sat Aug 08 2020 02:00:00 GMT+0200 (GMT+02:00)</span><div class=visuallyhidden itemprop=description><p>Festival i Jarom&#x11B;&#x159;, Tjeckien den 5-8 augusti 2020.</p></div><span class=visuallyhidden itemprop=address></span></li></ul></aside><footer><p>Publicerades <time>2007-08-20</time>. <a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr√∂m sedan dec 2006. <a rel=alternate href=../../prenumerera.xml>Prenumerera</a>. Korrekt HTML5 och CSS 3.</p></footer></body></html>