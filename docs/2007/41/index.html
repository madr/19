<!doctype html><html lang=sv><head><meta charset=UTF-8><title>Indexinkludering och adressf√§ltet | Anders Ytterstr√∂ms hemsida</title><meta name=viewport content="width=device-width"><link rel=stylesheet title="madr.se stilmall" href=/madrse.css><link href=/prenumerera.xml type=application/atom+xml rel=alternate title=madr.se><link rel=canonical href=https://madr.se//2007/41/ ><meta property=og:title content="Indexinkludering och adressf√§ltet"><meta property=og:type content=article><meta property=og:url content=https://madr.se//2007/41/ ><meta property=og:image content=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276><meta property=og:site_name content="Anders Ytterstr√∂ms hemsida"></head><body><a href=#content class=skiplink>Hoppa till inneh√•ll</a><header><a href=/ rel=home>madr.se</a><nav><a href=/bl/ >ü§ò Br√ºtal Legend</a> <a href=/evenemang/ >üìÖ Evenemang</a> <a href=/om/ >ü§∑‚Äç‚ôÇÔ∏è Om</a> <a href=/prenumerera.xml rel=alternate title="Prenumerera via Atom">üì£</a></nav></header><main id=content><p class=alert--archived><i>Detta √§r ett arkiverat inl√§gg, som importerats hit f√∂r referens. Det kan se konstigt ut och inneh√•lla utdaterad information eller inaktuella √•sikter.</i></p><article><h1>Indexinkludering och adressf√§ltet</h1><footer><time>2007-08-20</time> av <a rel=author href=/om><img src=https://sv.gravatar.com/avatar/981e98db0f85baaa05dddd1ee46a3276 alt=portr√§tt> Anders Ytterstr√∂m</a></footer><p>De senaste √•ren har det varit trendigt med indexinkludering i webbutvecklingssammanhang. Det finns en klar f√∂rdel med att g√∂ra detta, eftersom globala konventioner och inst√§llningar g√∂rs en g√•ng ist√§llet f√∂r flera. En nackdel √§r att det finns m√•nga fallgropar, s√§rskilt f√∂r nyb√∂rjare d√§r det kan g√• fel. Vanligaste misstaget √§r att HTML-utskriften sker selektivt: index.php inkluderar f√∂rst filen ./header.php och sedan <code>($_GET[&#39;page&#39;]).php</code>. Om den unika sidan misslyckas att skriva ut bem√∂ts anv√§ndaren av ett sidhuvud och ett kryptiskt felmeddelande n√•gonstans p√• sk√§rmen, vilket √§r alltifr√•n √∂nskv√§rt.</p><p>Vid anv√§ndning av t ex mallar och vyer √§r detta problem dock eliminerat, eftersom HTML-dokumentet kommer i en enda str√∂m ist√§llet f√∂r flera selektiva. Och problemet jag nyss beskrev √§r inte specifikt f√∂r applikationer med indexinkludering. Ett problem som d√§remot √§r en direkt verkan, och ett h√∂gst viktigt problem att ta itu med √§r det h√§r:</p><p><a href="http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28">http://madr.se/?controller=blog&amp;action=archive&amp;date=2007-08-28</a></p><p>Med indexinkludering blir det en massa parametrar som m√•ste skickas efter fr√•getecknet. En vanlig bes√∂kare ser detta som en enda l√•ng kryptisk kedja och visar med stor s√§kerhet inget intresse f√∂r den. Sj√§lv tycker jag om att kunna navigera direkt med adressf√§ltet, och jag f√∂rest√§ller mig att jag inte √§r ensam om att vilja det. Adressf√§ltet √§r ett verktyg som finns i webbl√§sare, precis som bak√•t- och fram√•tknapparna, och den √§r mest dominant sett till dess storlek. Det √§r farligt att neka anv√§ndare anv√§ndbarhet.</p><p>Indexinkludering st√§ller till det f√∂r gr√§nssnittet.</p><p>Den absolut b√§sta l√∂sningen p√• problemet om man har Apache eller IIS √§r att anv√§nda en omskrivningsmodul. I Apache heter denna <em>mod_rewrite</em>. Ovanst√•ende adress kan d√• skrivas om till</p><p><a href=http://madr.se/webblogg/2007/8/28>http://madr.se/webblogg/2007/8/28</a></p><p>Vilket √§r betydligt mer semantiskt och anv√§ndarv√§nligt. Vill en anv√§ndare kika p√• inl√§gg fr√•n 5:e september g√•r det att √§ndra direkt i adressf√§ltet.</p><p>Men omskrivningsmoduler g√•r aldrig att r√§kna med. De kr√§ver plattformsspecifik konfiguation, b√•de i webbapplikationerna och p√• webservern. Det kr√§ver ocks√• litet inl√§rning. En applikation som fungerar p√• utvecklingsservern som √§r Apache har ingen garanti att fungera om den skall anv√§ndas p√• en publik IIS-server. Ett webbhotell har ocks√• makten att neka kunder s√•dana moduler f√∂r deras s√§kerhetspolicies (har sett s√•dant h√§nda f√∂r 'mindre' saker √§n omskrivningsmoduler).</p><p>S√•vida man inte har en egen server eller 100% koll √§r det allts√• en risk att f√∂rlita sig p√• omskrivningsmoduler. Vad finns det f√∂r alternativ d√•, f√∂r att r√•da bukt p√• det tr√•kiga adressf√§ltet?</p><p>Faktum √§r att jag i detta fall predikar om att g√• tillbaka till enkelhet. L√•t alla sidor ligga i egna filer. V√•r testsida skulle i s√• fall se ut s√•h√§r:</p><p><a href="http://madr.se/webblogg/arkiv.php?date=2007-08-28">http://madr.se/webblogg/arkiv.php?date=2007-08-28</a></p><p>V√•r sidas adress har inte lika tv√§tts√§ker semantik som med omskrivningsmoduler, men det √§r betydligt b√§ttre. Dessutom √§r implementationen s√• enkel att den garanterat fungerar √∂verallt d√§r st√∂d f√∂r PHP finns. Det g√•r fortfarande att hantera utskrift med vyer, det g√•r fortfarande att skriva komplexa MVC:er och till√§mpa designm√∂nster, eftersom varje fil agerar som kontrollerare. De procedurer som index.php inneh√•ller i sammanhanget vid indexinkludering kan med f√∂rdel flyttas ut till en egen fil som inkluderas av varje kontrollerare. Det handlar om ett f√•tal rader extra kod.</p><p>Faktum √§r att jag suttit och lekt med just detta till MWA, som agerar skelett √•t den h√§r webbplatsen. Jag ville ha ett skalbart MVC d√§r det skulle g√• att skifta mellan anv√§ndande av frontcontroller i index.php och fallet med en fil f√∂r varje kontrollerare.</p><p>I min implementation finns det tv√• frontcontrollers f√∂r indexinkludering, d√§r den enda √§r beroende av mod_rewrite och den andra inte. B√•da implementerar <code>madr_interface_frontcontroller</code> och sk√∂ter litet inputvalidering och annat ut√∂ver att inkludera en kontrollerar-fil.</p><p>Konstanter och andra viktiga faktorer f√∂r k√∂rning ligger i init.php, som inkluderas p√• f√∂rsta raden.</p><p>Min filstruktur:</p><ul><li>/cache</li><li>/controller/pages</li><li>/controller/scripts</li><li>/lib</li><li>/log</li><li>/model</li><li>/public</li><li>/view</li></ul><p>Jag lyckades uppn√• s√•dan skalbarhet att jag endast beh√∂vde flytta kontrollerarna fr√•n controllers/pages och /controllers/scripts till /public, den enda katalogen som n√•s utifr√•n(normalt ligger endast index.php d√§r). I varje kontrollerare lade jag till</p><p><code>require &#39;../lib/init.php&#39;</code></p><p>√∂verst och i de kontrollerare som √§r 'pages' lade jag till</p><p><code>$view = new madr_view($vyfilens_namn); $view-&gt;compile();</code></p><p>sist i koden, d√• detta normalt s√§tt sk√∂ts av ett madr_controller objekt f√∂r mig. Och bevare mig v√§l, det fungerade. Jag √§r n√∂jd. :)</p><p>Nu n√§r jag slagit mig sj√§lv i ryggen litet f√∂r att jag √§r s√• bra(;p), s√• reflektera litet √∂ver mina tankar. Blir allt verkligen 'snyggare' och 'enklare' med indexinkludering?</p></article></main><footer><p><a href=https://creativecommons.org/licenses/by-sa/4.0/ lang=en>CC BY-SA 4.0</a> av Anders Ytterstr√∂m sedan dec 2006. <a rel=alternate href=/prenumerera.xml>Prenumerera</a>.</p></footer></body></html>